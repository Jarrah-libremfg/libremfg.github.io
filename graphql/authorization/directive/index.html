<!doctype html><html lang=en class="js csstransforms3d"><head><script>var subPaths={"/deploy/#install-dgraph":"/deploy/download","/deploy/#docker":"/deploy/download/#docker","/deploy/#automatic-download":"/deploy/download/#automatic-download","/deploy/#manual-download-[optional]":"/deploy/download/#manual-download-[optional]","/deploy/#building-from-source":"/deploy/download/#building-from-source","/deploy/#understanding-dgraph-cluster":"/deploy/cluster-setup/#understanding-dgraph-cluster","/deploy/#sharding":"/deploy/cluster-setup/#sharding","/deploy/#shard-rebalancing":"/deploy/cluster-setup/#shard-rebalancing","/deploy/#consistent-replication":"/deploy/cluster-setup/#consistent-replication","/deploy/#types-of-ports":"/deploy/ports-usage/#types-of-ports","/deploy/#ports-used-by-different-nodes":"/deploy/ports-usage/#ports-used-by-different-nodes","/deploy/#ha-cluster-setup":"/deploy/ports-usage/#ha-cluster-setup","/deploy/#dgraph-zero":"/deploy/ports-usage/#dgraph-zero","/deploy/#dgraph-alpha":"/deploy/ports-usage/#dgraph-alpha","/deploy/#run-directly-on-the-host":"/deploy/single-host-setup/#run-directly-on-the-host","/deploy/#run-dgraph-zero":"/deploy/single-host-setup/#run-dgraph-zero","/deploy/#run-dgraph-alpha":"/deploy/single-host-setup/#run-dgraph-alpha","/deploy/#run-dgraph-ui":"/deploy/single-host-setup/#run-dgraph-ui","/deploy/#run-using-docker":"/deploy/single-host-setup/#run-using-docker","/deploy/#create-docker-network":"/deploy/single-host-setup/#create-docker-network","/deploy/#run-dgraph-zero":"/deploy/single-host-setup/#run-dgraph-zero","/deploy/#run-dgraph-alpha":"/deploy/single-host-setup/#run-dgraph-alpha","/deploy/#run-dgraph-ui":"/deploy/single-host-setup/#run-dgraph-ui","/deploy/#run-using-docker-compose-(on-single-aws-instance)":"/deploy/single-host-setup/#run-using-docker-compose-(on-single-aws-instance)","/deploy/#using-docker-swarm":"/deploy/multi-host-setup/#using-docker-swarm","/deploy/#cluster-setup-using-docker-swarm":"/deploy/multi-host-setup/#cluster-setup-using-docker-swarm","/deploy/#ha-cluster-setup-using-docker-swarm":"/deploy/multi-host-setup/#ha-cluster-setup-using-docker-swarm","/deploy/#single-server":"/deploy/kubernetes/#single-server","/deploy/#deploy-single-server":"/deploy/kubernetes/#deploy-single-server","/deploy/#verify-single-server":"/deploy/kubernetes/#verify-single-server","/deploy/#test-single-server-setup":"/deploy/kubernetes/#test-single-server-setup","/deploy/#remove-single-server-resources":"/deploy/kubernetes/#remove-single-server-resources","/deploy/#ha-cluster-setup-using-kubernetes":"/deploy/kubernetes/#ha-cluster-setup-using-kubernetes","/deploy/#validate-kubernetes-cluster-for-ha":"/deploy/kubernetes/#validate-kubernetes-cluster-for-ha","/deploy/#verify-dgraph-ha-cluster":"/deploy/kubernetes/#verify-dgraph-ha-cluster","/deploy/#test-dgraph-ha-cluster-setup":"/deploy/kubernetes/#test-dgraph-ha-cluster-setup","/deploy/#delete-dgraph-ha-cluster-resources":"/deploy/kubernetes/#delete-dgraph-ha-cluster-resources","/deploy/#using-helm-chart":"/deploy/kubernetes/#using-helm-chart","/deploy/#installing-the-chart":"/deploy/kubernetes/#installing-the-chart","/deploy/#upgrading-the-chart":"/deploy/kubernetes/#upgrading-the-chart","/deploy/#deleting-the-chart":"/deploy/kubernetes/#deleting-the-chart","/deploy/#configuration":"/deploy/kubernetes/#configuration","/deploy/#monitoring-in-kubernetes":"/deploy/kubernetes/#monitoring-in-kubernetes","/deploy/#kubernetes-storage":"/deploy/kubernetes/#kubernetes-storage","/deploy/#local-storage":"/deploy/kubernetes/#local-storage","/deploy/#non-local-persistent-disks":"/deploy/kubernetes/#non-local-persistent-disks","/deploy/#removing-a-dgraph-pod":"/deploy/kubernetes/#removing-a-dgraph-pod","/deploy/#kubernetes-and-bulk-loader":"/deploy/kubernetes/#kubernetes-and-bulk-loader","/deploy/#more-about-dgraph-alpha":"/deploy/dgraph-alpha","/deploy/#querying-health":"/deploy/dgraph-alpha/#querying-health","/deploy/#more-about-dgraph-zero":"/deploy/dgraph-zero","/deploy/#more-about-state-endpoint":"/deploy/dgraph-zero/#more-about-state-endpoint","/deploy/#query-logging":"/deploy/log-format/#query-logging","/deploy/#dgraph-certificate-management-tool":"/deploy/tls-configuration/#dgraph-certificate-management-tool","/deploy/#file-naming-conventions":"/deploy/tls-configuration/#file-naming-conventions","/deploy/#certificate-inspection":"/deploy/tls-configuration/#certificate-inspection","/deploy/#tls-options":"/deploy/tls-configuration/#tls-options","/deploy/#using-tls-without-client-authentication":"/deploy/tls-configuration/#using-tls-without-client-authentication","/deploy/#using-tls-with-client-authentication":"/deploy/tls-configuration/#using-tls-with-client-authentication","/deploy/#client-authentication-options":"/deploy/tls-configuration/#client-authentication-options","/deploy/#using-ratel-ui-with-client-authentication":"/deploy/tls-configuration/#using-ratel-ui-with-client-authentication","/deploy/#using-curl-with-client-authentication":"/deploy/tls-configuration/#using-curl-with-client-authentication","/deploy/#access-data-using-a-client":"/deploy/tls-configuration/#access-data-using-a-client","/deploy/#troubleshooting-ratel-s-client-authentication":"/deploy/tls-configuration/#troubleshooting-ratel-s-client-authentication","/deploy/#live-loader":"/deploy/fast-data-loading/#live-loader","/deploy/#encrypted-imports-via-live-loader":"/deploy/fast-data-loading/#encrypted-imports-via-live-loader","/deploy/#encrypted-rdf-json-file-and-schema-via-live-loader":"/deploy/fast-data-loading/#encrypted-rdf-json-file-and-schema-via-live-loader","/deploy/#other-live-loader-options":"/deploy/fast-data-loading/#other-live-loader-options","/deploy/#bulk-loader":"/deploy/fast-data-loading/#bulk-loader","/deploy/#encryption-at-rest-with-bulk-loader":"/deploy/fast-data-loading/#encryption-at-rest-with-bulk-loader","/deploy/#encrypting-imports-via-bulk-loader":"/deploy/fast-data-loading/#encrypting-imports-via-bulk-loader","/deploy/#other-bulk-loader-options":"/deploy/fast-data-loading/#other-bulk-loader-options","/deploy/#tuning-monitoring":"/deploy/fast-data-loading/#tuning-monitoring","/deploy/#disk-metrics":"/deploy/metrics/#disk-metrics","/deploy/#memory-metrics":"/deploy/metrics/#memory-metrics","/deploy/#activity-metrics":"/deploy/metrics/#activity-metrics","/deploy/#health-metrics":"/deploy/metrics/#health-metrics","/deploy/#go-metrics":"/deploy/metrics/#go-metrics","/deploy/#examining-traces-with-zpages":"/deploy/tracing/#examining-traces-with-zpages","/deploy/#examining-traces-with-jaeger":"/deploy/tracing/#examining-traces-with-jaeger","/deploy/#setting-up-multiple-dgraph-clusters-with-jaeger":"/deploy/tracing/#setting-up-multiple-dgraph-clusters-with-jaeger","/deploy/#whitelisting-admin-operations":"/deploy/dgraph-administration/#whitelisting-admin-operations","/deploy/#restricting-mutation-operations":"/deploy/dgraph-administration/#restricting-mutation-operations","/deploy/#securing-alter-operations":"/deploy/dgraph-administration/#securing-alter-operations","/deploy/#export-database":"/deploy/dgraph-administration/#exporting-database","/deploy/#encrypting-exports":"/deploy/dgraph-administration/#encrypting-exports","/deploy/#shutting-down-database":"/deploy/dgraph-administration/#shutting-down-database","/deploy/#deleting-database":"/deploy/dgraph-administration/#deleting-database","/deploy/#upgrading-database":"/deploy/dgraph-administration/#upgrading-database","/deploy/#upgrading-from-v1-2-2-to-v20-03-0-for-enterprise-customers":"/deploy/dgraph-administration/#upgrading-from-v1-2-2-to-v20-03-0-for-enterprise-customers","/deploy/#post-installation":"/deploy/dgraph-administration/#post-installation","/deploy/#running-oom-out-of-memory":"/deploy/troubleshooting/#running-oom-out-of-memory","/deploy/#too-many-open-files":"/deploy/troubleshooting/#too-many-open-files","/deploy/#cluster-requirements":"/deploy/production-checklist/#cluster-requirements","/deploy/#machine-requirements":"/deploy/production-checklist/#machine-requirements","/deploy/#operating-system":"/deploy/production-checklist/#operating-system","/deploy/#cpu-and-memory":"/deploy/production-checklist/#cpu-and-memory","/deploy/#disk":"/deploy/production-checklist/#disk","/deploy/#firewall-rules":"/deployproduction-checklist/#firewall-rules","/deploy/#operating-system-tuning":"/deploy/production-checklist/#operating-system-tuning","/deploy/#deployment":"/deploy/production-checklist/#deployment","/deploy/#terminology":"/deploy/production-checklist/#terminology","/deploy/#basic-setup-2-node-cluster":"/deploy/production-checklist/#basic-setup-2-node-cluster","/deploy/#ha-setup-6-node-cluster":"/deploy/production-checklist/#ha-setup-6-node-cluster","/deploy/#supplementary-services":"/deploy/production-checklist/#supplementary-services","/deploy/#see-also":"/deploy/","/query-language/#take-a-tour-https-tour-dgraph-io":"/query-language/graphql-fundamentals/#take-a-tour-https-tour-dgraph-io","/query-language/#running-examples":"/query-language/graphql-fundamentals/#running-examples","/query-language/#graphql-fundamentals":"/query-language/graphql-fundamentals/#graphql-fundamentals","/query-language/#returning-values":"/query-language/graphql-fundamentals/#returning-values","/query-language/#expanding-graph-edges":"/query-language/graphql-fundamentals/#expanding-graph-edges","/query-language/#comments":"/query-language/graphql-fundamentals/#comments","/query-language/#applying-filters":"/query-language/graphql-fundamentals/#applying-filters","/query-language/#language-support":"/query-language/graphql-fundamentals/#language-support","/query-language/#functions":"/query-language/functions","/query-language/#term-matching":"/query-language/functions/#term-matching","/query-language/#allofterms":"/query-language/functions/#allofterms","/query-language/#usage-at-root":"/query-language/functions/#usage-at-root","/query-language/#usage-as-filter":"/query-language/functions/#usage-as-filter","/query-language/#anyofterms":"/query-language/functions/#anyofterms","/query-language/#usage-at-root-1":"/query-language/functions/#usage-at-root-1","/query-language/#usage-as-filter-1":"/query-language/functions/#usage-as-filter-1","/query-language/#regular-expressions":"/query-language/functions/#regular-expressions","/query-language/#technical-details":"/query-language/functions/#technical-details","/query-language/#writing-efficient-regular-expressions-and-limitations":"/query-language/functions/#writing-efficient-regular-expressions-and-limitations","/query-language/#fuzzy-matching":"/query-language/functions/#fuzzy-matching","/query-language/#full-text-search":"/query-language/functions/#full-text-search","/query-language/#inequality":"/query-language/functions/#inequality","/query-language/#equal-to":"/query-language/functions/#equal-to","/query-language/#less-than-less-than-or-equal-to-greater-than-and-greater-than-or-equal-to":"/query-language/functions/#less-than-less-than-or-equal-to-greater-than-and-greater-than-or-equal-to","/query-language/#uid":"/query-language/functions/#uid","/query-language/#uid-in":"/query-language/functions/#uid-in","/query-language/#has":"/query-language/functions/#has","/query-language/#geolocation":"/query-language/functions/#geolocation","/query-language/#mutations":"/query-language/functions/#mutations","/query-language/#query":"/query-language/functions/#query","/query-language/#near":"/query-language/functions/#near","/query-language/#within":"/query-language/functions/#within","/query-language/#contains":"/query-language/functions/#contains","/query-language/#intersects":"/query-language/functions/#intersects","/query-language/#connecting-filters":"/query-language/connecting-filters/","/query-language/#and-or-and-not":"/query-language/connecting-filters/#and-or-and-not","/query-language/#alias":"/query-language/alias","/query-language/#pagination":"/query-language/pagination","/query-language/#first":"/query-language/pagination/#first","/query-language/#offset":"/query-language/paginatio/n#offset","/query-language/#after":"/query-language/pagination/#after","/query-language/#count":"/query-language/count","/query-language/#sorting":"/query-language/sorting","/query-language/#multiple-query-blocks":"/query-language/multiple-query-blocks","/query-language/#var-blocks":"/query-language/multiple-query-blocks/#var-blocks","/query-language/#query-variables":"/query-language/query-variables/","/query-language/#value-variables":"/query-language/value-variables/","/query-language/#variable-propagation":"/query-language/value-variables/#variable-propagation","/query-language/#aggregation":"/query-language/aggregation/","/query-language/#min":"/query-language/aggregation/#min","/query-language/#usage-at-root-2":"/query-language/aggregation/#usage-at-root-2","/query-language/#usage-at-other-levels":"/query-language/aggregation/#usage-at-other-levels","/query-language/#max":"/query-language/aggregation/#max","/query-language/#usage-at-root-3":"/query-language/aggregation/#usage-at-root-3","/query-language/#usage-at-other-levels-1":"/query-language/aggregation/#usage-at-other-levels-1","/query-language/#sum-and-avg":"/query-language/aggregation/#sum-and-avg","/query-language/#usage-at-root-4":"/query-language/aggregation/#usage-at-root-4","/query-language/#usage-at-other-levels-2":"/query-language/aggregation/#usage-at-other-levels-2","/query-language/#aggregating-aggregates":"/query-language/aggregation/#aggregating-aggregates","/query-language/#math-on-value-variables":"/query-language/math-on-value-variables/","/query-language/#groupby":"/query-language/groupby/","/query-language/#expand-predicates":"/query-language/expand-predicates/","/query-language/#filtering-during-expand":"/query-language/expand-predicates/#filtering-during-expand","/query-language/#cascade-directive":"/query-language/cascade-directive/","/query-language/#normalize-directive":"/query-language/normalize-directive/","/query-language/#ignorereflex-directive":"/query-language/ignorereflex-directive/","/query-language/#debug":"/query-language/debug/","/query-language/#schema":"/query-language/schema/","/query-language/#schema-types":"/query-language/schema/#schema-types","/query-language/#scalar-types":"/query-language/schema/#scalar-types","/query-language/#uid-type":"/query-language/schema/#uid-type","/query-language/#adding-or-modifying-schema":"/query-language/schema/#adding-or-modifying-schema","/query-language/#indexes-in-background":"/query-language/schema/#indexes-in-background","/query-language/#http-api":"/query-language/schema/#http-api","/query-language/#grpc-api":"/query-language/schema/#grpc-api","/query-language/#predicate-name-rules":"/query-language/schema/#predicate-name-rules","/query-language/#allowed-special-characters":"/query-language/schema/#allowed-special-characters","/query-language/#forbidden-special-characters":"/query-language/schema/#forbidden-special-characters","/query-language/#predicates-i18n":"/query-language/schema/#predicates-i18n","/query-language/#upsert-directive":"/query-language/schema/#upsert-directive","/query-language/#noconflict-directive":"/query-language/schema/#noconflict-directive","/query-language/#rdf-types":"/query-language/schema/#rdf-types","/query-language/#extended-types":"/query-language/schema/#extended-types","/query-language/#password-type":"/query-language/schema/#password-type","/query-language/#indexing":"/query-language/schema/#indexing","/query-language/#string-indices":"/query-language/schema/#string-indices","/query-language/#datetime-indices":"/query-language/schema/#datetime-indices","/query-language/#sortable-indices":"/query-language/schema/#sortable-indices","/query-language/#count-index":"/query-language/schema/#count-index","/query-language/#list-type":"/query-language/schema/#list-type","/query-language/#filtering-on-list":"/query-language/schema/#filtering-on-list","/query-language/#reverse-edges":"/query-language/schema/#reverse-edges","/query-language/#querying-schema":"/query-language/schema/#querying-schema","/query-language/#type-system":"/query-language/type-system/","/query-language/#type-definition":"/query-language/schema/#type-definition","/query-language/#setting-the-type-of-a-node":"/query-language/schema/#setting-the-type-of-a-node","/query-language/#using-types-during-queries":"/query-language/schema/#using-types-during-queries","/query-language/#deleting-a-type":"/query-language/schema/#deleting-a-type","/query-language/#expand-queries-and-types":"/query-language/schema/#expand-queries-and-types","/query-language/#facets-edge-attributes":"/query-language/facets/","/query-language/#facets-on-scalar-predicates":"/query-language/facets/#facets-on-scalar-predicates","/query-language/#facets-i18n":"/query-language/facets/#facets-i18n","/query-language/#alias-with-facets":"/query-language/facets/#alias-with-facets","/query-language/#facets-on-uid-predicates":"/query-language/facets/#facets-on-uid-predicates","/query-language/#filtering-on-facets":"/query-language/facets/#filtering-on-facets","/query-language/#sorting-using-facets":"/query-language/facets/#sorting-using-facets","/query-language/#assigning-facet-values-to-a-variable":"/query-language/facets/#assigning-facet-values-to-a-variable","/query-language/#facets-and-variable-propagation":"/query-language/facets/#facets-and-variable-propagation","/query-language/#facets-and-aggregation":"/query-language/facets/#facets-and-aggregation","/query-language/#k-shortest-path-queries":"/query-language/k-shortest-path-queries/","/query-language/#recurse-query":"/query-language/recurse-query/","/query-language/#fragments":"/query-language/fragments/","/query-language/#graphql-variables":"/query-language/graphql-variables/","/query-language/#indexing-with-custom-tokenizers":"/query-language/indexing-custom-tokenizers/","/query-language/#caveats":"/query-language/indexing-custom-tokenizers/#caveats","/query-language/#implementing-a-plugin":"/query-language/indexing-custom-tokenizers/#implementing-a-plugin","/query-language/#building-the-plugin":"/query-language/indexing-custom-tokenizers/#building-the-plugin","/query-language/#running-dgraph-with-plugins":"/query-language/indexing-custom-tokenizers/#running-dgraph-with-plugins","/query-language/#adding-the-index-to-the-schema":"/query-language/indexing-custom-tokenizers/#adding-the-index-to-the-schema","/query-language/#using-the-index-in-queries":"/query-language/indexing-custom-tokenizers/#using-the-index-in-queries","/query-language/#examples":"/query-language/indexing-custom-tokenizers/#examples","/query-language/#unicode-characters":"/query-language/indexing-custom-tokenizers/#unicode-characters","/query-language/#cidr-range":"/query-language/indexing-custom-tokenizers/#cidr-range","/query-language/#anagram":"/query-language/indexing-custom-tokenizers/#anagram","/query-language/#integer-prime-factors":"/query-language/indexing-custom-tokenizers/#integer-prime-factors","/design-concepts/#can-we-do-pre-writes-only-on-leaders":"/design-concepts/transactions-faq/","/design-concepts/#edges":"/design-concepts/concepts/#edges","/design-concepts/#posting-list":"/design-concepts/concepts/#posting-list","/design-concepts/#badger":"/design-concepts/concepts/#badger","/design-concepts/#group":"/design-concepts/concepts/#group","/design-concepts/#replication-and-server-failure":"/design-concepts/concepts/#replication-and-server-failure","/design-concepts/#new-server-and-discovery":"/design-concepts/concepts/#new-server-and-discovery","/design-concepts/#write-ahead-logs":"/design-concepts/concepts/#write-ahead-logs","/design-concepts/#mutations":"/design-concepts/concepts/#mutations","/design-concepts/#queries":"/design-concepts/concepts/#queries","/design-concepts/#network-calls":"/design-concepts/concepts/#network-calls","/design-concepts/#worker":"/design-concepts/concepts/#worker","/design-concepts/#worker-pool":"/design-concepts/concepts/#worker-pool","/design-concepts/#protocol-buffers":"/design-concepts/concepts/#protocol-buffers","/design-concepts/#sql-nosql":"/design-concepts/minimizing-network-calls/#sql-nosql","/design-concepts/#dgraph":"/design-concepts/minimizing-network-calls/#dgraph","/design-concepts/#term":"/design-concepts/raft/#dgraph","/design-concepts/#server-states":"/design-concepts/raft/#server-states","/design-concepts/#communication":"/design-concepts/raft/#communication","/design-concepts/#log-entries":"/design-concepts/raft/#log-entries","/design-concepts/#voting":"/design-concepts/raft/#voting","/design-concepts/#cluster-membership":"/design-concepts/raft/#cluster-membership","/design-concepts/#log-compaction":"/design-concepts/raft/#log-compaction","/design-concepts/#clients":"/design-concepts/raft/#clients","/design-concepts/#linearizable-semantics":"/design-concepts/raft/#linearizable-semantics","/design-concepts/#read-only-queries":"/design-concepts/raft/#read-only-queries","/mutations/#deletion-of-non-list-predicates":"/mutations/delete/#deletion-of-non-list-predicates","/mutations/#setting-literal-values":"/mutations/json-mutation-format/#setting-literal-values","/mutations/#language-support":"/mutations/json-mutation-format/#language-support","/mutations/#geolocation-support":"/mutations/json-mutation-format/#geolocation-support","/mutations/#referencing-existing-nodes":"/mutations/json-mutation-format/#referencing-existing-nodes","/mutations/#edges-between-nodes":"/mutations/json-mutation-format/#edges-between-nodes","/mutations/#deleting-literal-values":"/mutations/json-mutation-format/#deleting-literal-values","/mutations/#deleting-edges":"/mutations/json-mutation-format/#deleting-edges","/mutations/#facets":"/mutations/json-mutation-format/#facets","/mutations/#deleting-facets":"/mutations/json-mutation-format/#deleting-facets","/mutations/#creating-a-list-with-json-and-interacting-with":"/mutations/json-mutation-format/#creating-a-list-with-json-and-interacting-with","/mutations/#facets-in-list-type-with-json":"/mutations/json-mutation-format/#facets-in-list-type-with-json","/mutations/#specifying-multiple-operations":"/mutations/json-mutation-format/#specifying-multiple-operations","/mutations/#json-syntax-using-raw-http-or-ratel-ui":"/mutations/json-mutation-format/#json-syntax-using-raw-http-or-ratel-ui","/mutations/#using-json-operations-via-curl":"/mutations/json-mutation-format/#using-json-operations-via-curl","/mutations/#uid-function":"/mutations/upsert-block/#uid-function","/mutations/#val-function":"/mutations/upsert-block/#val-function","/mutations/#example-of-uid-function":"/mutations/upsert-block/#example-of-uid-function","/mutations/#example-of-val-function":"/mutations/upsert-block/#example-of-val-function","/mutations/#bulk-delete-example":"/mutations/upsert-block/#bulk-delete-example","/mutations/#example-of-conditional-upsert":"/mutations/conditional-upsert/#example-of-conditional-upsert","/mutations/#example-of-multiple-mutation-blocks":"/mutations/conditional-upsert/#example-of-multiple-mutation-blocks","/enterprise-features/#configure-backup":"/enterprise-features/binary-backups/#configure-backup","/enterprise-features/#configure-amazon-s3-credentials":"/enterprise-features/binary-backups/#configure-amazon-s3-credentials","/enterprise-features/#configure-minio-credentials":"/enterprise-features/binary-backups/#configure-minio-credentials","/enterprise-features/#create-a-backup":"/enterprise-features/binary-backups/#create-a-backup","/enterprise-features/#backup-to-amazon-s3":"/enterprise-features/binary-backups/#backup-to-amazon-s3","/enterprise-features/#backup-to-minio":"/enterprise-features/binary-backups/#backup-to-minio","/enterprise-features/#backup-to-minio":"/enterprise-features/binary-backups/#backup-to-minio","/enterprise-features/#backup-to-google-cloud-storage-via-minio-gateway":"/enterprise-features/binary-backups/#backup-to-google-cloud-storage-via-minio-gateway","/enterprise-features/#test-using-minio-browser":"/enterprise-features/binary-backups/#test-using-minio-browser","/enterprise-features/#test-using-minio-client":"/enterprise-features/binary-backups/#test-using-minio-client","/enterprise-features/#disabling-https-for-s3-and-minio-backups":"/enterprise-features/binary-backups/#disabling-https-for-s3-and-minio-backups","/enterprise-features/#overriding-credentials":"/enterprise-features/binary-backups/#overriding-credentials","/enterprise-features/#backup-to-nfs":"/enterprise-features/binary-backups/#backup-to-nfs","/enterprise-features/#forcing-a-full-backup":"/enterprise-features/binary-backups/#forcing-a-full-backup","/enterprise-features/#encrypted-backups":"/enterprise-features/binary-backups/#encrypted-backups","/enterprise-features/#new-flag-“encrypted”-in-manifest.json":"/enterprise-features/binary-backups/#new-flag-“encrypted”-in-manifest.json","/enterprise-features/#aes-and-chaining-with-gzip":"/enterprise-features/binary-backups/#aes-and-chaining-with-gzip","/enterprise-features/#backup":"/enterprise-features/binary-backups/#backup","/enterprise-features/#restore-from-backup":"/enterprise-features/binary-backups/#restore-from-backup","/enterprise-features/#restore-from-amazon-s3":"/enterprise-features/binary-backups/#restore-from-amazon-s3","/enterprise-features/#restore-from-minio":"/enterprise-features/binary-backups/#restore-from-minio","/enterprise-features/#restore-from-local-directory-or-nfs":"/enterprise-features/binary-backups/#restore-from-local-directory-or-nfs","/enterprise-features/#restore-and-update-timestamp":"/enterprise-features/binary-backups/#restore-and-update-timestamp","/enterprise-features/#turn-on-acls":"/enterprise-features/access-control-lists/#turn-on-acls","/enterprise-features/#set-up-acl-rules":"/enterprise-features/access-control-lists/#set-up-acl-rules","/enterprise-features/#using-graphql-admin-api":"/enterprise-features/access-control-lists/#using-graphql-admin-api","/enterprise-features/#retrieve-users-and-groups-information":"/enterprise-features/access-control-lists/#retrieve-users-and-groups-information","/enterprise-features/#using-a-graphql-tool":"/enterprise-features/access-control-lists/#using-a-graphql-tool","/enterprise-features/#access-data-using-a-client":"/enterprise-features/access-control-lists/#access-data-using-a-client","/enterprise-features/#access-data-using-the-graphql-api":"/enterprise-features/access-control-lists/#access-data-using-the-graphql-api","/enterprise-features/#reset-groot-password":"/enterprise-features/access-control-lists/#reset-groot-password","/enterprise-features/#set-up-encryption":"/enterprise-features/encryption-at-rest/#set-up-encryption","/enterprise-features/#turn-on-encryption":"/enterprise-features/encryption-at-rest/#turn-on-encryption","/enterprise-features/#turn-off-encryption":"/enterprise-features/encryption-at-rest/#turn-off-encryption","/enterprise-features/#change-encryption-key":"/enterprise-features/encryption-at-rest/#change-encryption-key","/howto/#metrics-information":"/howto/retrieving-debug-information/#metrics-information","/howto/#profiling-information":"/howto/retrieving-debug-information/#profiling-information","/howto/#cpu-profile":"/howto/retrieving-debug-information/#cpu-profile","/howto/#memory-profile":"/howto/retrieving-debug-information/#memory-profile","/howto/#block-profile":"/howto/retrieving-debug-information/#block-profile","/howto/#goroutine-stack":"/howto/retrieving-debug-information/#goroutine-stack","/howto/#example-usage":"/howto/using-debug-tool/#example-usage","/howto/#debug-tool-output":"/howto/using-debug-tool/#debug-tool-output","/howto/#key-lookup":"/howto/using-debug-tool/#key-lookup","/howto/#key-history":"/howto/using-debug-tool/#key-history","/howto/#basic-integration":"/howto/dgraph-sentry-integration/#basic-integration","/howto/#data-handling":"/howto/dgraph-sentry-integration/#data-handling","/howto/#increment-tool-output":"/howto/using-increment-tool/#increment-tool-output","/howto/#download-zip":"/howto/load-balancing-nginx/#download-zip","/howto/#start-dgraph-cluster":"/howto/load-balancing-nginx/#start-dgraph-cluster","/howto/#use-the-increment-tool-to-start-a-grpc-lb":"/howto/load-balancing-nginx/#use-the-increment-tool-to-start-a-grpc-lb","/howto/#check-logs":"/howto/load-balancing-nginx/#check-logs","/howto/#upsert-procedure":"/howto/upserts/#upsert-procedure","/howto/#upsert-block":"/howto/upserts/#upsert-block","/howto/#conflicts":"/howto/upserts/#conflicts","/howto/#schema-types-scalar-uid-and-list-uid":"/howto/migrate-dgraph-1-1/#schema-types-scalar-uid-and-list-uid","/howto/#type-system":"/howto/migrate-dgraph-1-1/#type-system","/howto/#live-loader-and-bulk-loader-command-line-flags":"/howto/migrate-dgraph-1-1/#live-loader-and-bulk-loader-command-line-flags","/howto/#http-api":"/howto/migrate-dgraph-1-1/#http-api"},urlSplit,origPath,redirectPaths=["clients","query-language","mutations","deploy","enterprise-features","howto","design-concepts"],pathSplit=document.URL.split("/");redirectPaths.includes(pathSplit[pathSplit.length-2])&&(urlSplit=pathSplit[pathSplit.length-1].split("#"),origPath="/"+pathSplit[pathSplit.length-2]+"/#"+urlSplit[1],origPath in subPaths?(loc=""+subPaths[origPath],window.location.replace(loc)):urlSplit[1]&&(loc=""+pathSplit.slice(4,pathSplit.length-1).join("/")+"/#"+urlSplit[1],window.location.replace(loc)))</script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name=referrer content="no-referrer-when-downgrade"><meta name=generator content="Hugo 0.112.1"><meta name=description content="Given an authentication mechanism and a signed JSON Web Token (JWT), the @auth directive tells Dgraph how to apply authorization."><link rel=canonical href=/graphql/authorization/directive/><link rel=apple-touch-icon sizes=57x57 href=/images/favicons/apple-touch-icon-57x57.png><link rel=apple-touch-icon sizes=60x60 href=/images/favicons/apple-touch-icon-60x60.png><link rel=apple-touch-icon sizes=72x72 href=/images/favicons/apple-touch-icon-72x72.png><link rel=apple-touch-icon sizes=76x76 href=/images/favicons/apple-touch-icon-76x76.png><link rel=apple-touch-icon sizes=114x114 href=/images/favicons/apple-touch-icon-114x114.png><link rel=apple-touch-icon sizes=120x120 href=/images/favicons/apple-touch-icon-120x120.png><link rel=apple-touch-icon sizes=144x144 href=/images/favicons/apple-touch-icon-144x144.png><link rel=apple-touch-icon sizes=152x152 href=/images/favicons/apple-touch-icon-152x152.png><link rel=apple-touch-icon sizes=180x180 href=/images/favicons/apple-touch-icon-180x180.png><link rel=icon type=image/png href=/images/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/images/favicons/android-chrome-192x192.png sizes=192x192><link rel=icon type=image/png href=/images/favicons/favicon-194x194.png sizes=194x194><link rel=icon type=image/png href=/images/favicons/favicon-96x96.png sizes=96x96><link rel=icon type=image/png href=/images/favicons/favicon-16x16.png sizes=16x16><link rel=manifest href=/images/favicons/manifest.json><link rel=mask-icon href=/images/favicons/safari-pinned-tab.svg color=#fe2c06><link rel="shortcut icon" href=/images/favicons/favicon.ico><link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/styles/default.min.css><script src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/highlight.min.js></script>
<script async src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/languages/go.min.js></script>
<script async src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/languages/java.min.js integrity="sha256-RyOs5MjQ+Ef9DQrPHp4QGr2tcNjxLh6mCkkW+sS4doU=" crossorigin=anonymous></script>
<script src=//code.jquery.com/jquery-3.2.1.min.js integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin=anonymous></script>
<script src=//cdnjs.cloudflare.com/ajax/libs/codemirror/5.25.0/codemirror.js integrity="sha256-x3BtPVERvw1ozPlwivuFLZoViFCeAAs1Gt6SxEedmo8=" crossorigin=anonymous></script>
<link href=//cdnjs.cloudflare.com/ajax/libs/codemirror/5.25.0/codemirror.css rel=stylesheet integrity="sha256-7sZe9dsqyNZC9Mk+WPRB7nVvPPPXyorzm2QKqlgXC4k=" crossorigin=anonymous><script async src=//cdnjs.cloudflare.com/ajax/libs/codemirror/5.25.0/addon/edit/closebrackets.min.js integrity="sha256-qhu2a7DSpQaammMaLw1iruxBpxmgdw8mdQaQWQUokcY=" crossorigin=anonymous></script>
<script async src=//cdnjs.cloudflare.com/ajax/libs/codemirror/5.25.0/mode/javascript/javascript.min.js integrity="sha256-7Bdg/UdDMmHDPafpQDYZNPCEbnRP7eAvu+2hEoqRCXs=" crossorigin=anonymous></script><title>The @auth Directive in GraphQL - GraphQL</title><link href=/css/theme.css?6a79ff0832398fa8541cbaef6b6dd556 rel=stylesheet><link href=/css/runnable.css?46648956d99faa2e057d109b9f2a52e6 rel=stylesheet><link href=/css/tabs.css?035edc32762cb7973b740e3067101ced rel=stylesheet><link href=//maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css rel=stylesheet integrity=sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ crossorigin=anonymous><script src=//cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js integrity=sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb crossorigin=anonymous></script>
<script src=//maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js integrity=sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn crossorigin=anonymous></script>
<link href="//fonts.googleapis.com/css?family=Lato:400,700" rel=stylesheet><link href=//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css rel=stylesheet integrity=sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN crossorigin=anonymous><link href=https://cdn.lineicons.com/2.0/LineIcons.css rel=stylesheet crossorigin=anonymous><link rel=stylesheet href=//cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css><script>!function(){var t,n,e=window.analytics=window.analytics||[];if(!e.initialize)if(e.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{e.invoked=!0,e.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on","addSourceMiddleware","addIntegrationMiddleware","setAnonymousId","addDestinationMiddleware"],e.factory=function(t){return function(){var n=Array.prototype.slice.call(arguments);return n.unshift(t),e.push(n),e}};for(t=0;t<e.methods.length;t++)n=e.methods[t],e[n]=e.factory(n);e.load=function(t,n){var o,s=document.createElement("script");s.type="text/javascript",s.async=!0,s.src="https://cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js",o=document.getElementsByTagName("script")[0],o.parentNode.insertBefore(s,o),e._loadOptions=n},e._writeKey="aQlf725vSBKhpQnINiGBc6rCtFyVCiAP",e.SNIPPET_VERSION="4.13.2",e.load("aQlf725vSBKhpQnINiGBc6rCtFyVCiAP"),e.page(),document.addEventListener("DOMContentLoaded",()=>{const t=document.querySelectorAll("a");t.forEach(t=>e.trackLink(t,"Click",{id:t.id,to:t.href,text:t.innerText}))})}}()</script></head><body><nav id=header><div class=header-left><div><a href=https://libremfg.com/features-gql class=brand><img src=/images/libre-logo.png alt=libre class=logo></a><div class=logo-tagline><span>Baas Documentation</span></div></div></div><div class=header-right><div style=margin-top:10px><div class="menu-search align-middle"><div class=menu-search-inner><input type=search class="form-control form-control-sm" id=algolia-doc-search placeholder="Search documentation" aria-label="Search docs" autocomplete=off></div></div></div><div><ul class=menu><li><a href=https://libremfg.com/features-gql target=_blank>Home</a></li><li><a href=https://www.libremfg.com/pricing-gql/ target=_blank>Pricing</a></li><li><a href=https://discord.gg/vtJ7JE4sha target=_blank>Community</a></li><li><a href=https://github.com/libremfg/libremfg.github.io target=_blank>GitHub</a></li></ul></div></div><a href=# id=sidebar-toggle><i class="fa fa-bars"></i></a></nav><aside id=sidebar><div class=menu-header></div><ul class=topics><li class="topic main-topic children"><a id=datahub href=#>DataHub</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=/datahub/overview/>Overview</a></li><li class="topic sub-topic"><a href=/datahub/isa-95-data-model/>ISA 95 Data Model</a></li><li class="topic sub-topic"><a href=/datahub/streaming-data/>Streaming Data</a></li></ul></li><li class="topic main-topic"><a href=/>Home</a></li><li class="topic main-topic"><a href=/dgraph-overview/>Dgraph Overview</a></li><li class="topic main-topic children"><a id=bpmn href=#>BPMN</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=#>Events</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=/bpmn/events/overview/>Events Overview</a></li><li class="topic sub-topic"><a href=/bpmn/events/message/>Message Event</a></li><li class="topic sub-topic"><a href=/bpmn/events/timer/>Timer Event</a></li><li class="topic sub-topic"><a href=/bpmn/events/signal/>Signal Event</a></li><li class="topic sub-topic"><a href=/bpmn/events/escalation/>Escalation Event</a></li><li class="topic sub-topic"><a href=/bpmn/events/error/>Error Event</a></li><li class="topic sub-topic"><a href=/bpmn/events/conditional/>Conditional Event</a></li><li class="topic sub-topic"><a href=/bpmn/events/compensation/>Compensation Event</a></li></ul></li><li class="topic sub-topic"><a href=#>Gateways</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=/bpmn/gateways/overview/>Gateway Overview</a></li><li class="topic sub-topic"><a href=/bpmn/gateways/parallel/>Parallel Gateway</a></li><li class="topic sub-topic"><a href=/bpmn/gateways/inclusive/>Inclusive Gateway</a></li><li class="topic sub-topic"><a href=/bpmn/gateways/complex/>Complex Gateway</a></li><li class="topic sub-topic"><a href=/bpmn/gateways/event-based/>Event Based Gateway</a></li></ul></li><li class="topic sub-topic"><a href=#>Tasks</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=/bpmn/tasks/overview/>Tasks Overview</a></li></ul></li></ul></li><li class="topic main-topic children active"><a id=graphql href=#>GraphQL</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=/graphql/overview/>Overview</a></li><li class="topic sub-topic"><a href=/graphql/quick-start/>Quick Start</a></li><li class="topic sub-topic"><a href=/graphql/how-dgraph-graphql-works/>How GraphQL works in Dgraph</a></li><li class="topic sub-topic"><a href=#>To-Do List App Tutorial</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=/graphql/todo-app-tutorial/todo-overview/>Overview</a></li><li class="topic sub-topic"><a href=/graphql/todo-app-tutorial/todo-schema-design/>Schema Design</a></li><li class="topic sub-topic"><a href=/graphql/todo-app-tutorial/todo-ui/>Creating a Basic UI</a></li><li class="topic sub-topic"><a href=/graphql/todo-app-tutorial/todo-auth-rules/>Authorization Rules</a></li><li class="topic sub-topic"><a href=/graphql/todo-app-tutorial/todo-auth0-jwt/>Using Auth0</a></li><li class="topic sub-topic"><a href=/graphql/todo-app-tutorial/todo-firebase-jwt/>Using Firebase Authentication</a></li><li class="topic sub-topic"><a href=/graphql/todo-app-tutorial/deploy/>Deploying on Dgraph Cloud</a></li></ul></li><li class="topic sub-topic active"><a href=#>Authorization</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=/graphql/authorization/authorization-overview/>Overview</a></li><li class="topic sub-topic active"><a href=/graphql/authorization/directive/>The @auth Directive</a></li><li class="topic sub-topic"><a href=/graphql/authorization/mutations/>Mutations</a></li></ul></li><li class="topic sub-topic"><a href=#>API</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=/graphql/api/api-overview/>Overview</a></li><li class="topic sub-topic"><a href=/graphql/api/requests/>Requests and Responses</a></li><li class="topic sub-topic"><a href=/graphql/api/variables/>GraphQL Variables</a></li><li class="topic sub-topic"><a href=/graphql/api/fragments/>GraphQL Fragments</a></li><li class="topic sub-topic"><a href=/graphql/api/multiples/>Multiple GraphQL Operations in a Request</a></li><li class="topic sub-topic"><a href=/graphql/api/errors/>GraphQL Errors</a></li></ul></li><li class="topic sub-topic"><a href=#>Schema</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=/graphql/schema/schema-overview/>Overview</a></li><li class="topic sub-topic"><a href=/graphql/schema/reserved/>Reserved Names</a></li><li class="topic sub-topic"><a href=/graphql/schema/migration/>Schema Migration</a></li><li class="topic sub-topic"><a href=/graphql/schema/types/>Types</a></li><li class="topic sub-topic"><a href=/graphql/schema/ids/>IDs</a></li><li class="topic sub-topic"><a href=/graphql/schema/graph-links/>Links in the Graph</a></li><li class="topic sub-topic"><a href=/graphql/schema/search/>Search and Filtering</a></li><li class="topic sub-topic"><a href=/graphql/schema/documentation/>Documentation and Comments</a></li><li class="topic sub-topic"><a href=/graphql/schema/deprecated/>Deprecation</a></li><li class="topic sub-topic"><a href=/graphql/schema/dgraph-schema/>Dgraph Schema Fragment</a></li><li class="topic sub-topic"><a href=/graphql/schema/default/>@default Directive</a></li></ul></li><li class="topic sub-topic"><a href=#>Queries</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=/graphql/queries/queries-overview/>Overview</a></li><li class="topic sub-topic"><a href=/graphql/queries/search-filtering/>Search and Filtering</a></li><li class="topic sub-topic"><a href=/graphql/queries/aggregate/>Aggregate Queries</a></li><li class="topic sub-topic"><a href=/graphql/queries/persistent-queries/>Persistent Queries</a></li><li class="topic sub-topic"><a href=/graphql/queries/and-or-not/>And, Or and Not</a></li><li class="topic sub-topic"><a href=/graphql/queries/cached-results/>Cached Results</a></li><li class="topic sub-topic"><a href=/graphql/queries/order-page/>Order and Pagination</a></li><li class="topic sub-topic"><a href=/graphql/queries/cascade/>@cascade Directive</a></li><li class="topic sub-topic"><a href=/graphql/queries/skip-include/>@skip and @include Directives</a></li></ul></li><li class="topic sub-topic"><a href=#>Mutations</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=/graphql/mutations/mutations-overview/>Overview</a></li><li class="topic sub-topic"><a href=/graphql/mutations/add/>Add</a></li><li class="topic sub-topic"><a href=/graphql/mutations/upsert/>Upsert</a></li><li class="topic sub-topic"><a href=/graphql/mutations/update/>Update</a></li><li class="topic sub-topic"><a href=/graphql/mutations/delete/>Delete</a></li><li class="topic sub-topic"><a href=/graphql/mutations/deep/>Deep</a></li></ul></li><li class="topic sub-topic"><a href=/graphql/subscriptions/>Subscriptions</a></li><li class="topic sub-topic"><a href=#>Custom Resolvers</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=/graphql/custom/custom-overview/>Overview</a></li><li class="topic sub-topic"><a href=/graphql/custom/directive/>The @custom Directive</a></li><li class="topic sub-topic"><a href=/graphql/custom/query/>Custom Queries</a></li><li class="topic sub-topic"><a href=/graphql/custom/mutation/>Custom Mutations</a></li><li class="topic sub-topic"><a href=/graphql/custom/field/>Custom Fields</a></li><li class="topic sub-topic"><a href=/graphql/custom/dql/>Custom DQL</a></li></ul></li><li class="topic sub-topic"><a href=#>Lambda Resolvers</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=/graphql/lambda/overview/>Overview</a></li><li class="topic sub-topic"><a href=/graphql/lambda/field/>Lambda Fields</a></li><li class="topic sub-topic"><a href=/graphql/lambda/query/>Lambda Queries</a></li><li class="topic sub-topic"><a href=/graphql/lambda/mutation/>Lambda Mutations</a></li><li class="topic sub-topic"><a href=/graphql/lambda/webhook/>Lambda Webhooks</a></li><li class="topic sub-topic"><a href=/graphql/lambda/server/>Lambda Server</a></li></ul></li><li class="topic sub-topic"><a href=/graphql/directives/>Directives</a></li><li class="topic sub-topic"><a href=/graphql/admin/>Administrative API</a></li><li class="topic sub-topic"><a href=/graphql/dgraph/>GraphQL on Existing Dgraph</a></li><li class="topic sub-topic"><a href=/graphql/federation/>Apollo Federation</a></li></ul></li><li class="topic main-topic children"><a id=deploy-and-manage href=#>Deploy and Manage</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=/deploy/overview/>Deployment and Management Overview</a></li><li class="topic sub-topic"><a href=/deploy/download/>Download Dgraph</a></li><li class="topic sub-topic"><a href=/deploy/config/>Configuration</a></li><li class="topic sub-topic"><a href=/deploy/dgraph-zero/>More about Dgraph Zero</a></li><li class="topic sub-topic"><a href=/deploy/dgraph-alpha/>More about Dgraph Alpha</a></li><li class="topic sub-topic"><a href=/deploy/single-host-setup/>Single Host Setup</a></li><li class="topic sub-topic"><a href=/deploy/multi-host-setup/>Multi-Host Setup</a></li><li class="topic sub-topic"><a href=/deploy/kubernetes/>Using Kubernetes</a></li><li class="topic sub-topic"><a href=/deploy/cluster-setup/>Cluster Setup</a></li><li class="topic sub-topic"><a href=/deploy/cluster-checklist/>Cluster Checklist</a></li><li class="topic sub-topic"><a href=/deploy/production-checklist/>Production Checklist</a></li><li class="topic sub-topic"><a href=#>Administration</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=/deploy/dgraph-administration/>Dgraph Administration</a></li><li class="topic sub-topic"><a href=/deploy/log-format/>Logging</a></li><li class="topic sub-topic"><a href=/deploy/ludicrous-mode/>Ludicrous Mode</a></li><li class="topic sub-topic"><a href=/deploy/monitoring/>Monitoring</a></li><li class="topic sub-topic"><a href=/deploy/metrics/>Metrics</a></li><li class="topic sub-topic"><a href=/deploy/tracing/>Tracing</a></li><li class="topic sub-topic"><a href=/deploy/data-compression/>Data compression on Disk</a></li></ul></li><li class="topic sub-topic"><a href=#>Fast Data Loading</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=/deploy/fast-data-loading/overview/>Overview</a></li><li class="topic sub-topic"><a href=/deploy/fast-data-loading/bulk-loader/>Bulk Loader</a></li><li class="topic sub-topic"><a href=/deploy/fast-data-loading/live-loader/>Live Loader</a></li></ul></li><li class="topic sub-topic"><a href=#>Security</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=/deploy/ports-usage/>Ports Usage</a></li><li class="topic sub-topic"><a href=/deploy/tls-configuration/>TLS Configuration</a></li></ul></li><li class="topic sub-topic"><a href=/deploy/decrypt/>Data Decryption</a></li><li class="topic sub-topic"><a href=/deploy/cli-command-reference/>Dgraph CLI Reference</a></li><li class="topic sub-topic"><a href=/deploy/troubleshooting/>Troubleshooting</a></li></ul></li><li class="topic main-topic children"><a id=enterprise-features href=#>Enterprise Features</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=/enterprise-features/audit-logs/>Audit Logging</a></li><li class="topic sub-topic"><a href=/enterprise-features/lsbackup/>Backup List Tool</a></li><li class="topic sub-topic"><a href=/enterprise-features/binary-backups/>Binary Backups</a></li><li class="topic sub-topic"><a href=/enterprise-features/encryption-at-rest/>Encryption at Rest</a></li><li class="topic sub-topic"><a href=/enterprise-features/learner-nodes/>Learner Nodes</a></li><li class="topic sub-topic"><a href=/enterprise-features/license/>License</a></li></ul></li><li class="topic main-topic children"><a id=migration href=#>Migration</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=/migration/loading-csv-data/>Loading CSV Data</a></li><li class="topic sub-topic"><a href=/migration/migrate-tool/>Migration Tool</a></li><li class="topic sub-topic"><a href=/migration/migrate-dgraph-1-1/>Migrate from Dgraph v1.0</a></li><li class="topic sub-topic"><a href=/migration/dgraph-compared-to-other-databases/>Dgraph Compared to Other Databases</a></li></ul></li><li class="topic main-topic"><a href=/faq/>FAQ</a></li><li class="topic main-topic children"><a id=how-to-guides href=#>How To Guides</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=/howto/retrieving-debug-information/>Retrieving Debug Information</a></li><li class="topic sub-topic"><a href=/howto/completion/>Shell Completion</a></li><li class="topic sub-topic"><a href=/howto/using-debug-tool/>Using the Debug Tool</a></li><li class="topic sub-topic"><a href=/howto/dgraph-sentry-integration/>Using the Dgraph Sentry Integration</a></li><li class="topic sub-topic"><a href=/howto/using-increment-tool/>Using the Increment Tool</a></li><li class="topic sub-topic"><a href=/howto/giving-nodes-type/>Giving Nodes a Type</a></li><li class="topic sub-topic"><a href=/howto/login-system/>A Simple Login System</a></li><li class="topic sub-topic"><a href=/howto/load-balancing-nginx/>Load Balancing Queries with NGINX</a></li><li class="topic sub-topic"><a href=/howto/upserts/>Upserts</a></li><li class="topic sub-topic"><a href=/howto/jepsen-tests/>Run Jepsen Tests</a></li><li class="topic sub-topic"><a href=/howto/lambda-webhooks-example/>Lambda Webhooks Example</a></li></ul></li><li class="topic main-topic children"><a id=design-concepts href=#>Design Concepts</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=/design-concepts/transactions-faq/>Transactions: FAQ</a></li><li class="topic sub-topic"><a href=/design-concepts/consistency-model/>Consistency Model</a></li><li class="topic sub-topic"><a href=/design-concepts/concepts/>Concepts</a></li><li class="topic sub-topic"><a href=/design-concepts/minimizing-network-calls/>How Dgraph Minimizes Network Calls</a></li><li class="topic sub-topic"><a href=/design-concepts/raft/>RAFT</a></li></ul></li><li class="topic main-topic"><a href=/releases/>Releases</a></li><li class="topic main-topic children"><a id=dql href=#>dql</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=/get-started/>Get Started</a></li><li class="topic sub-topic"><a href=/tutorials/>Tutorials</a></li><li class="topic sub-topic"><a href=#>Query Language Reference</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=/query-language/graphql-fundamentals/>DQL Fundamentals</a></li><li class="topic sub-topic"><a href=/query-language/functions/>Functions</a></li><li class="topic sub-topic"><a href=/query-language/connecting-filters/>Connecting Filters</a></li><li class="topic sub-topic"><a href=/query-language/alias/>Aliases</a></li><li class="topic sub-topic"><a href=/query-language/pagination/>Pagination in DQL</a></li><li class="topic sub-topic"><a href=/query-language/count/>Count</a></li><li class="topic sub-topic"><a href=/query-language/sorting/>Sorting</a></li><li class="topic sub-topic"><a href=/query-language/multiple-query-blocks/>Multiple Query Blocks</a></li><li class="topic sub-topic"><a href=/query-language/query-variables/>Query Variables</a></li><li class="topic sub-topic"><a href=/query-language/value-variables/>Value Variables</a></li><li class="topic sub-topic"><a href=/query-language/aggregation/>Aggregation</a></li><li class="topic sub-topic"><a href=/query-language/math-on-value-variables/>Math on Value Variables</a></li><li class="topic sub-topic"><a href=/query-language/groupby/>GroupBy</a></li><li class="topic sub-topic"><a href=/query-language/expand-predicates/>Expand Predicates</a></li><li class="topic sub-topic"><a href=/query-language/cascade-directive/>Cascade Directive</a></li><li class="topic sub-topic"><a href=/query-language/normalize-directive/>@normalize Directive</a></li><li class="topic sub-topic"><a href=/query-language/ignorereflex-directive/>@ignorereflex Directive</a></li><li class="topic sub-topic"><a href=/query-language/debug/>Debug</a></li><li class="topic sub-topic"><a href=/query-language/schema/>Schemas in DQL</a></li><li class="topic sub-topic"><a href=/query-language/type-system/>Type System</a></li><li class="topic sub-topic"><a href=/query-language/facets/>Facets and Edge Attributes</a></li><li class="topic sub-topic"><a href=/query-language/kshortest-path-quries/>Shortest Path Queries</a></li><li class="topic sub-topic"><a href=/query-language/recurse-query/>Recurse Query</a></li><li class="topic sub-topic"><a href=/query-language/fragments/>Fragments</a></li><li class="topic sub-topic"><a href=/query-language/graphql-variables/>GraphQL Variables</a></li><li class="topic sub-topic"><a href=/query-language/indexing-custom-tokenizers/>Indexing with Custom Tokenizers</a></li></ul></li><li class="topic sub-topic"><a href=/tips/>Tips and Tricks</a></li><li class="topic sub-topic"><a href=#>Mutations</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=/mutations/triples/>Triples</a></li><li class="topic sub-topic"><a href=/mutations/blank-nodes/>Blank Nodes and UIDs</a></li><li class="topic sub-topic"><a href=/mutations/external-ids/>External IDs</a></li><li class="topic sub-topic"><a href=/mutations/external-ids-upsert-block/>External IDs and Upsert Block</a></li><li class="topic sub-topic"><a href=/mutations/language-rdf-types/>Language and RDF Types</a></li><li class="topic sub-topic"><a href=/mutations/batch-mutations/>Batch Mutations</a></li><li class="topic sub-topic"><a href=/mutations/delete/>Delete</a></li><li class="topic sub-topic"><a href=/mutations/facets-in-list-type-with-rdf/>Facet Lists in RDF</a></li><li class="topic sub-topic"><a href=/mutations/mutations-using-curl/>Mutations Using cURL</a></li><li class="topic sub-topic"><a href=/mutations/json-mutation-format/>JSON Mutation Format</a></li><li class="topic sub-topic"><a href=/mutations/upsert-block/>Upsert Blocks</a></li><li class="topic sub-topic"><a href=/mutations/conditional-upsert/>Conditional Upsert</a></li><li class="topic sub-topic"><a href=/mutations/reverse-edges/>Reverse Edges</a></li></ul></li></ul></li></ul><ul class=sidebar-menu><li><a href=https://dgraph.io/ target=_blank>Home</a></li><li><a href=https://discuss.dgraph.io/ target=_blank>Community</a></li><li><a href=https://github.com/dgraph-io/dgraph target=_blank>GitHub</a></li></ul></aside><main class=content-wrapper><div class=content><div class=top-toc><nav id=TableOfContents><ul><li><a href=#authorization-rules>Authorization rules</a></li><li><a href=#auth-on-interfaces><code>@auth</code> on Interfaces</a><ul><li><a href=#implementing-types>Implementing types</a></li><li><a href=#interfaces>Interfaces</a></li><li><a href=#mutations>Mutations</a></li></ul></li><li><a href=#graph-traversal-in-auth-rules>Graph traversal in auth rules</a></li><li><a href=#role-based-access-control>Role Based Access Control</a></li><li><a href=#and-or--not>and, or & not</a></li><li><a href=#public-data>Public Data</a></li></ul></nav></div><article><a class=question-btn target=_blank href=https://discord.com/invite/vtJ7JE4sha><i class="fa fa-question-circle"></i> Ask a Question</a><h1 class=post-title>The @auth Directive in GraphQL</h1><div><p>The <code>@auth</code> directive tells Dgraph how to apply authorization. You can use it
to define authorization rules for most types (except for <code>union</code> and <code>@remote</code>
types). It lets you control which users can run which queries - as well as
which users can add, update, and delete data using mutations.</p><p>Additionally, you can use this directive with the <a href=/graphql/schema/types#password-type><code>@secret</code></a>
directive; and, if you specify a <code>password</code> authorization rule, Dgraph will use
it to authorize the <code>check&lt;Type>Password</code> query.</p><div class="notices note"><span class=type>Note</span> The <a href=/graphql/schema/types#union-type>Union type</a> does not support the <code>@auth</code> directive.</div><p>You create authorization rules using the <code>@auth</code> directive, and those rules are
expressed in exactly the same syntax as GraphQL queries. Why? Because the
authorization you add to your app is about the graph of your application, so
graph rules make sense. It&rsquo;s also a syntax that you already know about, and you
get syntax help from GraphQL tools in writing such rules. And these are exactly
the kinds of rules Dgraph already knows how to evaluate.</p><h2 id=authorization-rules>Authorization rules</h2><p>A valid type and rule looks like the following:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-graphql data-lang=graphql><span style=display:flex><span><span style=color:#00f>type</span> <span style=color:#2b91af>Todo</span> @auth(
</span></span><span style=display:flex><span>    <span style=color:#00f>query</span>: { <span style=color:#2b91af>rule</span>: <span style=color:#a31515>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#a31515>        query ($USER: String!) { 
</span></span></span><span style=display:flex><span><span style=color:#a31515>            queryTodo(filter: { owner: { eq: $USER } } ) { 
</span></span></span><span style=display:flex><span><span style=color:#a31515>                id 
</span></span></span><span style=display:flex><span><span style=color:#a31515>            } 
</span></span></span><span style=display:flex><span><span style=color:#a31515>        }&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#2b91af>add</span>: { <span style=color:#2b91af>rule</span>: <span style=color:#a31515>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#a31515>        query ($USER: String!) { 
</span></span></span><span style=display:flex><span><span style=color:#a31515>            queryTodo(filter: { owner: { eq: $USER } } ) { 
</span></span></span><span style=display:flex><span><span style=color:#a31515>                id 
</span></span></span><span style=display:flex><span><span style=color:#a31515>            } 
</span></span></span><span style=display:flex><span><span style=color:#a31515>        }&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#2b91af>delete</span>: { <span style=color:#2b91af>rule</span>: <span style=color:#a31515>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#a31515>        query ($USER: String!) { 
</span></span></span><span style=display:flex><span><span style=color:#a31515>            queryTodo(filter: { owner: { eq: $USER } } ) { 
</span></span></span><span style=display:flex><span><span style=color:#a31515>                id 
</span></span></span><span style=display:flex><span><span style=color:#a31515>            } 
</span></span></span><span style=display:flex><span><span style=color:#a31515>        }&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#2b91af>update</span>: { <span style=color:#2b91af>rule</span>: <span style=color:#a31515>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#a31515>        query ($USER: String!) { 
</span></span></span><span style=display:flex><span><span style=color:#a31515>            queryTodo(filter: { owner: { eq: $USER } } ) { 
</span></span></span><span style=display:flex><span><span style=color:#a31515>                id 
</span></span></span><span style=display:flex><span><span style=color:#a31515>            } 
</span></span></span><span style=display:flex><span><span style=color:#a31515>        }&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>){
</span></span><span style=display:flex><span>    <span style=color:#2b91af>id</span>: <span style=color:#2b91af>ID</span>!
</span></span><span style=display:flex><span>    <span style=color:#2b91af>text</span>: <span style=color:#2b91af>String</span>! @search(by: [<span style=color:#2b91af>term</span>])
</span></span><span style=display:flex><span>    owner: <span style=color:#2b91af>String</span>! @search(by: [<span style=color:#2b91af>hash</span>])
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class="notices note"><span class=type>Note</span> To use the <code>@auth</code> directive, you must configure the authentication method used
by Dgraph in the last line of your schema with a <code>Dgraph.Authorization</code> object,
as described in the <a href=/graphql/authorization/authorization-overview>Authorization Overview</a>.</div><p>Here we define a type <code>Todo</code>, that has an <code>id</code>, the <code>text</code> of the todo and the username of the <code>owner</code> of the todo. What todos can a user query? Any <code>Todo</code> that the <code>query</code> rule would also return.</p><p>The <code>query</code> rule in this case expects the JWT to contain a claim <code>"USER": "..."</code> giving the username of the logged in user, and says: you can query any todo that has your username as the owner.</p><p>In this example we use the <code>queryTodo</code> query that will be auto generated after uploading this schema. When using a query in a rule, you can only use the <code>queryTypeName</code> query. Where <code>TypeName</code> matches the name of the type, where the <code>@auth</code> directive is attached. In other words, we could not have used the <code>getTodo</code> query in our rule above to query by id only.</p><p>This rule is applied automatically at query time. For example, the query</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-graphql data-lang=graphql><span style=display:flex><span><span style=color:#00f>query</span> {
</span></span><span style=display:flex><span>    <span style=color:#2b91af>queryTodo</span> {
</span></span><span style=display:flex><span>        id
</span></span><span style=display:flex><span>        text
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>will return only the todo&rsquo;s where <code>owner</code> equals <code>amit</code>, when Amit is logged in and only the todos owned by <code>nancy</code> when she&rsquo;s logged into your app.</p><p>Similarly,</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-graphql data-lang=graphql><span style=display:flex><span><span style=color:#00f>query</span> {
</span></span><span style=display:flex><span>    <span style=color:#2b91af>queryTodo</span>(filter: { <span style=color:#2b91af>text</span>: { <span style=color:#2b91af>anyofterms</span>: <span style=color:#a31515>&#34;graphql&#34;</span>}}, <span style=color:#2b91af>first</span>: 10, <span style=color:#2b91af>order</span>: { <span style=color:#2b91af>asc</span>: <span style=color:#2b91af>text</span> }) {
</span></span><span style=display:flex><span>        id
</span></span><span style=display:flex><span>        text
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>will return the first ten todos, ordered ascending by title of the user that made the query.</p><p>This means your frontend doesn&rsquo;t need to be sensitive to the auth rules. Your app can simply query for the todos and that query behaves properly depending on who&rsquo;s logged in.</p><p>In general, an auth rule should select a field that&rsquo;s expected to exist at the inner most field, often that&rsquo;s the <code>ID</code> or <code>@id</code> field. Auth rules are run in a mode that requires all fields in the rule to find a value in order to succeed.</p><h2 id=auth-on-interfaces><code>@auth</code> on Interfaces</h2><p>The <code>@auth</code> directive works just like it does for types, and provides authorization to perform <code>query</code>, <code>update</code>, and <code>delete</code> on interfaces.</p><h3 id=implementing-types>Implementing types</h3><p>The rules provided inside the <code>@auth</code> directive on an interface will also be applied as an <code>AND</code> rule to those on the implementing types.</p><div class="notices tip"><span class=type>Tip</span> A type inherits the <code>@auth</code> rules of all the implemented interfaces. The final authorization rule is an <code>AND</code> of the type&rsquo;s <code>@auth</code> rule and of all the implemented interfaces.</div><p>In the following example, the <code>Question</code> and <code>Answer</code> types will automatically inherit the auth rules of the <code>Post</code> type.
This means that a user can only query a subset of questions and answers that are accessible through the <code>queryPost</code> query.
Dgraph will disallow situations where a user can query more posts through <code>queryAnswer</code> or <code>queryQuestion</code> than they can through <code>queryPost</code>.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-graphql data-lang=graphql><span style=display:flex><span><span style=color:#00f>type</span> <span style=color:#2b91af>Author</span> {
</span></span><span style=display:flex><span>  id: <span style=color:#2b91af>ID</span>!
</span></span><span style=display:flex><span>  name: <span style=color:#2b91af>String</span>! @search(by: [<span style=color:#2b91af>hash</span>])
</span></span><span style=display:flex><span>  posts: [<span style=color:#2b91af>Post</span>] @hasInverse(field: <span style=color:#2b91af>author</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>interface</span> <span style=color:#2b91af>Post</span> @auth(
</span></span><span style=display:flex><span>    <span style=color:green># The JWT should contain a claim &#34;USER&#34;, which should be the ID of the logged in author.</span>
</span></span><span style=display:flex><span>    <span style=color:green># This query rule would ensure that the logged-in author sees only their posts.</span>
</span></span><span style=display:flex><span>    <span style=color:#00f>query</span>: { <span style=color:#2b91af>rule</span>: <span style=color:#a31515>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#a31515>        query ($USER: ID!) { 
</span></span></span><span style=display:flex><span><span style=color:#a31515>            queryPost {
</span></span></span><span style=display:flex><span><span style=color:#a31515>              author(filter: { id: [$USER] }) {
</span></span></span><span style=display:flex><span><span style=color:#a31515>                id
</span></span></span><span style=display:flex><span><span style=color:#a31515>              }
</span></span></span><span style=display:flex><span><span style=color:#a31515>            } 
</span></span></span><span style=display:flex><span><span style=color:#a31515>        }&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>){
</span></span><span style=display:flex><span>  <span style=color:#2b91af>id</span>: <span style=color:#2b91af>ID</span>!
</span></span><span style=display:flex><span>  <span style=color:#2b91af>text</span>: <span style=color:#2b91af>String</span> @search(by: [<span style=color:#2b91af>fulltext</span>])
</span></span><span style=display:flex><span>  datePublished: <span style=color:#2b91af>DateTime</span> @search
</span></span><span style=display:flex><span>  author: <span style=color:#2b91af>Author</span>! 
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>type</span> <span style=color:#2b91af>Question</span> <span style=color:#00f>implements</span> <span style=color:#2b91af>Post</span> @auth(
</span></span><span style=display:flex><span>    <span style=color:green># The JWT should contain a boolean claim &#34;ANSWERED&#34;.</span>
</span></span><span style=display:flex><span>    <span style=color:green># This query rule would ensure that only the questions that have the answered field matching </span>
</span></span><span style=display:flex><span>    <span style=color:green># the ANSWERED claim are returned in response.</span>
</span></span><span style=display:flex><span>    <span style=color:#00f>query</span>: { <span style=color:#2b91af>rule</span>: <span style=color:#a31515>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#a31515>        query ($ANSWERED: Boolean!) { 
</span></span></span><span style=display:flex><span><span style=color:#a31515>            queryQuestion(filter: { answered: $ANSWERED } ) { 
</span></span></span><span style=display:flex><span><span style=color:#a31515>                id 
</span></span></span><span style=display:flex><span><span style=color:#a31515>            } 
</span></span></span><span style=display:flex><span><span style=color:#a31515>        }&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>){
</span></span><span style=display:flex><span>  <span style=color:#2b91af>answered</span>: <span style=color:#2b91af>Boolean</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#2b91af>type</span> Answer <span style=color:#00f>implements</span> <span style=color:#2b91af>Post</span> @auth(
</span></span><span style=display:flex><span>    <span style=color:green># The JWT should contain a boolean claim &#34;USEFUL&#34;.</span>
</span></span><span style=display:flex><span>    <span style=color:green># This query rule would ensure that only the answers that have the markedUseful field matching</span>
</span></span><span style=display:flex><span>    <span style=color:green># the USEFUL claim are returned in response.</span>
</span></span><span style=display:flex><span>    <span style=color:#00f>query</span>: { <span style=color:#2b91af>rule</span>: <span style=color:#a31515>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#a31515>        query ($USEFUL:Boolean!) { 
</span></span></span><span style=display:flex><span><span style=color:#a31515>            queryAnswer(filter: { markedUseful: $USEFUL } ) { 
</span></span></span><span style=display:flex><span><span style=color:#a31515>                id 
</span></span></span><span style=display:flex><span><span style=color:#a31515>            } 
</span></span></span><span style=display:flex><span><span style=color:#a31515>        }&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>){
</span></span><span style=display:flex><span>  <span style=color:#2b91af>markedUseful</span>: <span style=color:#2b91af>Boolean</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>If the <code>Question</code> type implemented more interfaces, then the rules for those would also be added in an <code>AND</code> condition to the <code>Question</code> type&rsquo;s authorization rules.</p><h3 id=interfaces>Interfaces</h3><p>When it comes to applying <code>@auth</code> rules on interfaces themselves, Dgraph will do a <code>union</code> query where it queries all the implementing types, and apply the authorization rules on them.
The final query will be an <code>OR</code> query joining the results from all the implementing types.</p><h3 id=mutations>Mutations</h3><p>Mutations on an interface works in the same manner. For example, in case of a <code>delete</code> mutation on an interface, it will be broken down into the implementing type&rsquo;s <code>delete</code> mutation. The nodes that satisfy the <code>@auth</code> rules of the corresponding implementing types and the interface will get deleted.</p><h2 id=graph-traversal-in-auth-rules>Graph traversal in auth rules</h2><p>Often authorization depends not on the object being queried, but on the connections in the graph that object has or doesn&rsquo;t have.
Because the auth rules are graph queries, they can express very powerful graph search and traversal.</p><p>For a simple todo app, it&rsquo;s more likely that you&rsquo;ll have types like this:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-graphql data-lang=graphql><span style=display:flex><span><span style=color:#00f>type</span> <span style=color:#2b91af>User</span> {
</span></span><span style=display:flex><span>    username: <span style=color:#2b91af>String</span>! @id
</span></span><span style=display:flex><span>    todos: [<span style=color:#2b91af>Todo</span>]
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>type</span> <span style=color:#2b91af>Todo</span> {
</span></span><span style=display:flex><span>    id: <span style=color:#2b91af>ID</span>!
</span></span><span style=display:flex><span>    text: <span style=color:#2b91af>String</span>!
</span></span><span style=display:flex><span>    owner: <span style=color:#2b91af>User</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>This means your auth rule for todos will depend not on a value in the todo, but on checking which owner it&rsquo;s linked to.
This means our auth rule must make a step further into the graph to check who the owner is.</p><p>So, you will have to modify the above schema like this:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-graphql data-lang=graphql><span style=display:flex><span><span style=color:#00f>type</span> <span style=color:#2b91af>User</span> {
</span></span><span style=display:flex><span>	username: <span style=color:#2b91af>String</span>! @id
</span></span><span style=display:flex><span>	todos: [<span style=color:#2b91af>Todo</span>]
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>type</span> <span style=color:#2b91af>Todo</span> @auth(
</span></span><span style=display:flex><span>    <span style=color:#00f>query</span>: { <span style=color:#2b91af>rule</span>: <span style=color:#a31515>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#a31515>        query ($USER: String!) {
</span></span></span><span style=display:flex><span><span style=color:#a31515>            queryTodo {
</span></span></span><span style=display:flex><span><span style=color:#a31515>                owner(filter: { username: { eq: $USER } } ) {
</span></span></span><span style=display:flex><span><span style=color:#a31515>                    username
</span></span></span><span style=display:flex><span><span style=color:#a31515>                }
</span></span></span><span style=display:flex><span><span style=color:#a31515>            }
</span></span></span><span style=display:flex><span><span style=color:#a31515>        }&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>){
</span></span><span style=display:flex><span>	<span style=color:#2b91af>id</span>: <span style=color:#2b91af>ID</span>!
</span></span><span style=display:flex><span>	<span style=color:#2b91af>text</span>: <span style=color:#2b91af>String</span>!
</span></span><span style=display:flex><span>	owner: <span style=color:#2b91af>User</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>You can express a lot with these kinds of graph traversals. For example, multitenancy rules can express that you can only see an object if it&rsquo;s linked (through what ever graph search you define) to the organization you were authenticated from. That means your app can split data per customer easily.</p><p>You can also express rules that can be administered by the app itself. You might define type <code>Role</code> and enum <code>Privileges</code> that can have values like <code>VIEW</code>, <code>ADD</code>, etc. and state in your auth rules that a user needs to have a role with particular privileges to query/add/update/delete and those roles can then be allocated inside the app. For example, in an app about project management, when a project is created the admin can decide which users have view or edit permission, etc.</p><h2 id=role-based-access-control>Role Based Access Control</h2><p>As well as rules that relate a user&rsquo;s claims to a graph traversal, role based access control rules are also possible. These rules relate a claim in the JWT to a known value.</p><p>For example, perhaps only someone logged in with the <code>ADMIN</code> role is allowed to delete users. For that, we might expect the JWT to contain a claim <code>"ROLE": "ADMIN"</code>, and can thus express a rule that only allows users with the <code>ADMIN</code> claim to delete.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-graphql data-lang=graphql><span style=display:flex><span><span style=color:#00f>type</span> <span style=color:#2b91af>User</span> @auth(
</span></span><span style=display:flex><span>    delete: { <span style=color:#2b91af>rule</span>:  <span style=color:#a31515>&#34;{$ROLE: { eq: \&#34;ADMIN\&#34; } }&#34;</span>}
</span></span><span style=display:flex><span>) { 
</span></span><span style=display:flex><span>    <span style=color:#2b91af>username</span>: <span style=color:#2b91af>String</span>! @id
</span></span><span style=display:flex><span>    todos: [<span style=color:#2b91af>Todo</span>]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Not all claims need to be present in all JWTs. For example, if the <code>ROLE</code> claim isn&rsquo;t present in a JWT, any rule that relies on <code>ROLE</code> simply evaluates to false. As well as simplifying your JWTs (e.g. not all users need a role if it doesn&rsquo;t make sense to do so), this means you can also simply disallow some queries and mutations. If you know that your JWTs never contain the claim <code>DENIED</code>, then a rule such as</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-graphql data-lang=graphql><span style=display:flex><span><span style=color:#00f>type</span> <span style=color:#2b91af>User</span> @auth(
</span></span><span style=display:flex><span>    delete: { <span style=color:#2b91af>rule</span>:  <span style=color:#a31515>&#34;{$DENIED: { eq: \&#34;DENIED\&#34; } }&#34;</span>}
</span></span><span style=display:flex><span>) { 
</span></span><span style=display:flex><span>    <span style=color:#00f>...</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>can never be true and this would prevent users ever being deleted.</p><h2 id=and-or--not>and, or & not</h2><p>Rules can be combined with the logical connectives and, or and not, so a permission can be a mixture of graph traversals and role based rules.</p><p>In the todo app, you can express, for example, that you can delete a <code>Todo</code> if you are the author, or are the site admin.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-graphql data-lang=graphql><span style=display:flex><span><span style=color:#00f>type</span> <span style=color:#2b91af>Todo</span> @auth(
</span></span><span style=display:flex><span>    delete: { <span style=color:#2b91af>or</span>: [ 
</span></span><span style=display:flex><span>        { <span style=color:#2b91af>rule</span>:  <span style=color:#a31515>&#34;query ($USER: String!) { ... }&#34;</span> }, <span style=color:green># you are the author graph query</span>
</span></span><span style=display:flex><span>        { <span style=color:#2b91af>rule</span>:  <span style=color:#a31515>&#34;{$ROLE: { eq: \&#34;ADMIN\&#34; } }&#34;</span> }
</span></span><span style=display:flex><span>    ]}
</span></span><span style=display:flex><span>)
</span></span></code></pre></div><h2 id=public-data>Public Data</h2><p>Many apps have data that can be accessed by anyone, logged in or not. That also works nicely with Dgraph auth rules.</p><p>For example, in Twitter, StackOverflow, etc. you can see authors and posts without being signed it - but you&rsquo;d need to be signed in to add a post. With Dgraph auth rules, if a type doesn&rsquo;t have, for example, a <code>query</code> auth rule or the auth rule doesn&rsquo;t depend on a JWT value, then the data can be accessed without a signed JWT.</p><p>For example, the todo app might allow anyone, logged in or not, to view any author, but not make any mutations unless logged in as the author or an admin. That would be achieved by rules like the following.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-graphql data-lang=graphql><span style=display:flex><span><span style=color:#00f>type</span> <span style=color:#2b91af>User</span> @auth(
</span></span><span style=display:flex><span>    <span style=color:green># no query rule</span>
</span></span><span style=display:flex><span>    add: { <span style=color:#2b91af>rule</span>:  <span style=color:#a31515>&#34;{$ROLE: { eq: \&#34;ADMIN\&#34; } }&#34;</span> },
</span></span><span style=display:flex><span>    <span style=color:#2b91af>update</span>: <span style=color:#00f>...</span>
</span></span><span style=display:flex><span>    <span style=color:#2b91af>delete</span>: <span style=color:#00f>...</span>
</span></span><span style=display:flex><span>) {
</span></span><span style=display:flex><span>    <span style=color:#2b91af>username</span>: <span style=color:#2b91af>String</span>! @id
</span></span><span style=display:flex><span>    todos: [<span style=color:#2b91af>Todo</span>]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Maybe some todos can be marked as public and users you aren&rsquo;t logged in can see those.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-graphql data-lang=graphql><span style=display:flex><span><span style=color:#00f>type</span> <span style=color:#2b91af>Todo</span> @auth(
</span></span><span style=display:flex><span>    <span style=color:#00f>query</span>: { <span style=color:#2b91af>or</span>: [
</span></span><span style=display:flex><span>        <span style=color:green># you are the author </span>
</span></span><span style=display:flex><span>        { <span style=color:#2b91af>rule</span>: <span style=color:#00f>...</span> },
</span></span><span style=display:flex><span>        <span style=color:green># or, the todo is marked as public</span>
</span></span><span style=display:flex><span>        { <span style=color:#2b91af>rule</span>: <span style=color:#a31515>&#34;&#34;&#34;query { 
</span></span></span><span style=display:flex><span><span style=color:#a31515>            queryTodo(filter: { isPublic: { eq: true } } ) { 
</span></span></span><span style=display:flex><span><span style=color:#a31515>                id 
</span></span></span><span style=display:flex><span><span style=color:#a31515>            } 
</span></span></span><span style=display:flex><span><span style=color:#a31515>        }&#34;&#34;&#34;</span>}
</span></span><span style=display:flex><span>    ]}
</span></span><span style=display:flex><span>) { 
</span></span><span style=display:flex><span>    <span style=color:#00f>...</span>
</span></span><span style=display:flex><span>    <span style=color:#2b91af>isPublic</span>: <span style=color:#2b91af>Boolean</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Because the rule doesn&rsquo;t depend on a JWT value, it can be successfully evaluated for users who aren&rsquo;t logged in.</p><p>Ensuring that requests are from an authenticated JWT, and no further restrictions, can be done by arranging the JWT to contain a value like <code>"isAuthenticated": "true"</code>. For example,</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-graphql data-lang=graphql><span style=display:flex><span><span style=color:#00f>type</span> <span style=color:#2b91af>User</span> @auth(
</span></span><span style=display:flex><span>    <span style=color:#00f>query</span>: { <span style=color:#2b91af>rule</span>:  <span style=color:#a31515>&#34;{$isAuthenticated: { eq: \&#34;true\&#34; } }&#34;</span> },
</span></span><span style=display:flex><span>) {
</span></span><span style=display:flex><span>    <span style=color:#2b91af>username</span>: <span style=color:#2b91af>String</span>! @id
</span></span><span style=display:flex><span>    <span style=color:#2b91af>todos</span>: [<span style=color:#2b91af>Todo</span>]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>specifies that only authenticated users can query other users.</p><hr></div><div class=post__comments><footer class=clearfix><a class=question-btn target=_blank href=https://discord.com/invite/vtJ7JE4sha><i class="fa fa-question-circle"></i> Ask a Question</a>
<a class=edit-btn target=_blank href=https://github.com/libremfg/libremfg.github.io/issues><i class="fa fa-github-alt"></i> Edit Page</a></footer></div></article><div class=right-toc><nav id=TableOfContents><ul><li><a href=#authorization-rules>Authorization rules</a></li><li><a href=#auth-on-interfaces><code>@auth</code> on Interfaces</a><ul><li><a href=#implementing-types>Implementing types</a></li><li><a href=#interfaces>Interfaces</a></li><li><a href=#mutations>Mutations</a></li></ul></li><li><a href=#graph-traversal-in-auth-rules>Graph traversal in auth rules</a></li><li><a href=#role-based-access-control>Role Based Access Control</a></li><li><a href=#and-or--not>and, or & not</a></li><li><a href=#public-data>Public Data</a></li></ul></nav></div></div></main><div class="modal fade" id=runnable-modal tabindex=-1 role=dialog aria-labelledby=exampleModalLabel aria-hidden=true><a href=# data-dismiss=modal class=modal-close-btn>Close</a><div class=modal-dialog role=document><div class=modal-content><div class=modal-body></div></div></div></div><script type=text/javascript src=https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js></script>
<script type=text/javascript>if(window.docsearch){var version="latest",path=window.location.pathname,arr=/(?:\/)?((?:master)|(?:v[0-9][^/]+))(?:\/)?.*$/.exec(path);arr!=null&&arr.length>1&&(version=arr[1]),window.docsearch({apiKey:"fe4cbc1640c6c87bbc5f099902d86f97",indexName:"dgraph",inputSelector:"#algolia-doc-search",algoliaOptions:{filters:`version:${version}`},debug:!1})}</script><script type=text/javascript>adroll_adv_id="L42C3U2UXBBPVAMISVXVLC",adroll_pix_id="MOR4VUNPK5B2LHEZ2NNTDX",adroll_version="2.0",function(e,t,n,s,o){e.__adroll_loaded=!0,e.adroll=e.adroll||[],e.adroll.f=["setProperties","identify","track"];var i="https://s.adroll.com/j/"+adroll_adv_id+"/roundtrip.js";for(o=0;o<e.adroll.f.length;o++)e.adroll[e.adroll.f[o]]=e.adroll[e.adroll.f[o]]||function(t){return function(){e.adroll.push([t,arguments])}}(e.adroll.f[o]);n=t.createElement("script"),s=t.getElementsByTagName("script")[0],n.async=1,n.src=i,s.parentNode.insertBefore(n,s)}(window,document),adroll.track("pageView")</script><script src=/js/clipboard.min.js></script>
<script src=/js/dgraph.js?a9873668f1334ff6c49d4edea0a4bc38></script>
<script src=/js/runnable.js?6e7f328df4134d18ba5c8dd11f84deb8></script>
<script>hljs.initHighlightingOnLoad()</script></body></html>