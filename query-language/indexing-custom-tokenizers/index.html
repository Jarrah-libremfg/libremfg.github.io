<!doctype html><html lang=en class="js csstransforms3d"><head><script>var subPaths={"/deploy/#install-dgraph":"/deploy/download","/deploy/#docker":"/deploy/download/#docker","/deploy/#automatic-download":"/deploy/download/#automatic-download","/deploy/#manual-download-[optional]":"/deploy/download/#manual-download-[optional]","/deploy/#building-from-source":"/deploy/download/#building-from-source","/deploy/#understanding-dgraph-cluster":"/deploy/cluster-setup/#understanding-dgraph-cluster","/deploy/#sharding":"/deploy/cluster-setup/#sharding","/deploy/#shard-rebalancing":"/deploy/cluster-setup/#shard-rebalancing","/deploy/#consistent-replication":"/deploy/cluster-setup/#consistent-replication","/deploy/#types-of-ports":"/deploy/ports-usage/#types-of-ports","/deploy/#ports-used-by-different-nodes":"/deploy/ports-usage/#ports-used-by-different-nodes","/deploy/#ha-cluster-setup":"/deploy/ports-usage/#ha-cluster-setup","/deploy/#dgraph-zero":"/deploy/ports-usage/#dgraph-zero","/deploy/#dgraph-alpha":"/deploy/ports-usage/#dgraph-alpha","/deploy/#run-directly-on-the-host":"/deploy/single-host-setup/#run-directly-on-the-host","/deploy/#run-dgraph-zero":"/deploy/single-host-setup/#run-dgraph-zero","/deploy/#run-dgraph-alpha":"/deploy/single-host-setup/#run-dgraph-alpha","/deploy/#run-dgraph-ui":"/deploy/single-host-setup/#run-dgraph-ui","/deploy/#run-using-docker":"/deploy/single-host-setup/#run-using-docker","/deploy/#create-docker-network":"/deploy/single-host-setup/#create-docker-network","/deploy/#run-dgraph-zero":"/deploy/single-host-setup/#run-dgraph-zero","/deploy/#run-dgraph-alpha":"/deploy/single-host-setup/#run-dgraph-alpha","/deploy/#run-dgraph-ui":"/deploy/single-host-setup/#run-dgraph-ui","/deploy/#run-using-docker-compose-(on-single-aws-instance)":"/deploy/single-host-setup/#run-using-docker-compose-(on-single-aws-instance)","/deploy/#using-docker-swarm":"/deploy/multi-host-setup/#using-docker-swarm","/deploy/#cluster-setup-using-docker-swarm":"/deploy/multi-host-setup/#cluster-setup-using-docker-swarm","/deploy/#ha-cluster-setup-using-docker-swarm":"/deploy/multi-host-setup/#ha-cluster-setup-using-docker-swarm","/deploy/#single-server":"/deploy/kubernetes/#single-server","/deploy/#deploy-single-server":"/deploy/kubernetes/#deploy-single-server","/deploy/#verify-single-server":"/deploy/kubernetes/#verify-single-server","/deploy/#test-single-server-setup":"/deploy/kubernetes/#test-single-server-setup","/deploy/#remove-single-server-resources":"/deploy/kubernetes/#remove-single-server-resources","/deploy/#ha-cluster-setup-using-kubernetes":"/deploy/kubernetes/#ha-cluster-setup-using-kubernetes","/deploy/#validate-kubernetes-cluster-for-ha":"/deploy/kubernetes/#validate-kubernetes-cluster-for-ha","/deploy/#verify-dgraph-ha-cluster":"/deploy/kubernetes/#verify-dgraph-ha-cluster","/deploy/#test-dgraph-ha-cluster-setup":"/deploy/kubernetes/#test-dgraph-ha-cluster-setup","/deploy/#delete-dgraph-ha-cluster-resources":"/deploy/kubernetes/#delete-dgraph-ha-cluster-resources","/deploy/#using-helm-chart":"/deploy/kubernetes/#using-helm-chart","/deploy/#installing-the-chart":"/deploy/kubernetes/#installing-the-chart","/deploy/#upgrading-the-chart":"/deploy/kubernetes/#upgrading-the-chart","/deploy/#deleting-the-chart":"/deploy/kubernetes/#deleting-the-chart","/deploy/#configuration":"/deploy/kubernetes/#configuration","/deploy/#monitoring-in-kubernetes":"/deploy/kubernetes/#monitoring-in-kubernetes","/deploy/#kubernetes-storage":"/deploy/kubernetes/#kubernetes-storage","/deploy/#local-storage":"/deploy/kubernetes/#local-storage","/deploy/#non-local-persistent-disks":"/deploy/kubernetes/#non-local-persistent-disks","/deploy/#removing-a-dgraph-pod":"/deploy/kubernetes/#removing-a-dgraph-pod","/deploy/#kubernetes-and-bulk-loader":"/deploy/kubernetes/#kubernetes-and-bulk-loader","/deploy/#more-about-dgraph-alpha":"/deploy/dgraph-alpha","/deploy/#querying-health":"/deploy/dgraph-alpha/#querying-health","/deploy/#more-about-dgraph-zero":"/deploy/dgraph-zero","/deploy/#more-about-state-endpoint":"/deploy/dgraph-zero/#more-about-state-endpoint","/deploy/#query-logging":"/deploy/log-format/#query-logging","/deploy/#dgraph-certificate-management-tool":"/deploy/tls-configuration/#dgraph-certificate-management-tool","/deploy/#file-naming-conventions":"/deploy/tls-configuration/#file-naming-conventions","/deploy/#certificate-inspection":"/deploy/tls-configuration/#certificate-inspection","/deploy/#tls-options":"/deploy/tls-configuration/#tls-options","/deploy/#using-tls-without-client-authentication":"/deploy/tls-configuration/#using-tls-without-client-authentication","/deploy/#using-tls-with-client-authentication":"/deploy/tls-configuration/#using-tls-with-client-authentication","/deploy/#client-authentication-options":"/deploy/tls-configuration/#client-authentication-options","/deploy/#using-ratel-ui-with-client-authentication":"/deploy/tls-configuration/#using-ratel-ui-with-client-authentication","/deploy/#using-curl-with-client-authentication":"/deploy/tls-configuration/#using-curl-with-client-authentication","/deploy/#access-data-using-a-client":"/deploy/tls-configuration/#access-data-using-a-client","/deploy/#troubleshooting-ratel-s-client-authentication":"/deploy/tls-configuration/#troubleshooting-ratel-s-client-authentication","/deploy/#live-loader":"/deploy/fast-data-loading/#live-loader","/deploy/#encrypted-imports-via-live-loader":"/deploy/fast-data-loading/#encrypted-imports-via-live-loader","/deploy/#encrypted-rdf-json-file-and-schema-via-live-loader":"/deploy/fast-data-loading/#encrypted-rdf-json-file-and-schema-via-live-loader","/deploy/#other-live-loader-options":"/deploy/fast-data-loading/#other-live-loader-options","/deploy/#bulk-loader":"/deploy/fast-data-loading/#bulk-loader","/deploy/#encryption-at-rest-with-bulk-loader":"/deploy/fast-data-loading/#encryption-at-rest-with-bulk-loader","/deploy/#encrypting-imports-via-bulk-loader":"/deploy/fast-data-loading/#encrypting-imports-via-bulk-loader","/deploy/#other-bulk-loader-options":"/deploy/fast-data-loading/#other-bulk-loader-options","/deploy/#tuning-monitoring":"/deploy/fast-data-loading/#tuning-monitoring","/deploy/#disk-metrics":"/deploy/metrics/#disk-metrics","/deploy/#memory-metrics":"/deploy/metrics/#memory-metrics","/deploy/#activity-metrics":"/deploy/metrics/#activity-metrics","/deploy/#health-metrics":"/deploy/metrics/#health-metrics","/deploy/#go-metrics":"/deploy/metrics/#go-metrics","/deploy/#examining-traces-with-zpages":"/deploy/tracing/#examining-traces-with-zpages","/deploy/#examining-traces-with-jaeger":"/deploy/tracing/#examining-traces-with-jaeger","/deploy/#setting-up-multiple-dgraph-clusters-with-jaeger":"/deploy/tracing/#setting-up-multiple-dgraph-clusters-with-jaeger","/deploy/#whitelisting-admin-operations":"/deploy/dgraph-administration/#whitelisting-admin-operations","/deploy/#restricting-mutation-operations":"/deploy/dgraph-administration/#restricting-mutation-operations","/deploy/#securing-alter-operations":"/deploy/dgraph-administration/#securing-alter-operations","/deploy/#export-database":"/deploy/dgraph-administration/#exporting-database","/deploy/#encrypting-exports":"/deploy/dgraph-administration/#encrypting-exports","/deploy/#shutting-down-database":"/deploy/dgraph-administration/#shutting-down-database","/deploy/#deleting-database":"/deploy/dgraph-administration/#deleting-database","/deploy/#upgrading-database":"/deploy/dgraph-administration/#upgrading-database","/deploy/#upgrading-from-v1-2-2-to-v20-03-0-for-enterprise-customers":"/deploy/dgraph-administration/#upgrading-from-v1-2-2-to-v20-03-0-for-enterprise-customers","/deploy/#post-installation":"/deploy/dgraph-administration/#post-installation","/deploy/#running-oom-out-of-memory":"/deploy/troubleshooting/#running-oom-out-of-memory","/deploy/#too-many-open-files":"/deploy/troubleshooting/#too-many-open-files","/deploy/#cluster-requirements":"/deploy/production-checklist/#cluster-requirements","/deploy/#machine-requirements":"/deploy/production-checklist/#machine-requirements","/deploy/#operating-system":"/deploy/production-checklist/#operating-system","/deploy/#cpu-and-memory":"/deploy/production-checklist/#cpu-and-memory","/deploy/#disk":"/deploy/production-checklist/#disk","/deploy/#firewall-rules":"/deployproduction-checklist/#firewall-rules","/deploy/#operating-system-tuning":"/deploy/production-checklist/#operating-system-tuning","/deploy/#deployment":"/deploy/production-checklist/#deployment","/deploy/#terminology":"/deploy/production-checklist/#terminology","/deploy/#basic-setup-2-node-cluster":"/deploy/production-checklist/#basic-setup-2-node-cluster","/deploy/#ha-setup-6-node-cluster":"/deploy/production-checklist/#ha-setup-6-node-cluster","/deploy/#supplementary-services":"/deploy/production-checklist/#supplementary-services","/deploy/#see-also":"/deploy/","/query-language/#take-a-tour-https-tour-dgraph-io":"/query-language/graphql-fundamentals/#take-a-tour-https-tour-dgraph-io","/query-language/#running-examples":"/query-language/graphql-fundamentals/#running-examples","/query-language/#graphql-fundamentals":"/query-language/graphql-fundamentals/#graphql-fundamentals","/query-language/#returning-values":"/query-language/graphql-fundamentals/#returning-values","/query-language/#expanding-graph-edges":"/query-language/graphql-fundamentals/#expanding-graph-edges","/query-language/#comments":"/query-language/graphql-fundamentals/#comments","/query-language/#applying-filters":"/query-language/graphql-fundamentals/#applying-filters","/query-language/#language-support":"/query-language/graphql-fundamentals/#language-support","/query-language/#functions":"/query-language/functions","/query-language/#term-matching":"/query-language/functions/#term-matching","/query-language/#allofterms":"/query-language/functions/#allofterms","/query-language/#usage-at-root":"/query-language/functions/#usage-at-root","/query-language/#usage-as-filter":"/query-language/functions/#usage-as-filter","/query-language/#anyofterms":"/query-language/functions/#anyofterms","/query-language/#usage-at-root-1":"/query-language/functions/#usage-at-root-1","/query-language/#usage-as-filter-1":"/query-language/functions/#usage-as-filter-1","/query-language/#regular-expressions":"/query-language/functions/#regular-expressions","/query-language/#technical-details":"/query-language/functions/#technical-details","/query-language/#writing-efficient-regular-expressions-and-limitations":"/query-language/functions/#writing-efficient-regular-expressions-and-limitations","/query-language/#fuzzy-matching":"/query-language/functions/#fuzzy-matching","/query-language/#full-text-search":"/query-language/functions/#full-text-search","/query-language/#inequality":"/query-language/functions/#inequality","/query-language/#equal-to":"/query-language/functions/#equal-to","/query-language/#less-than-less-than-or-equal-to-greater-than-and-greater-than-or-equal-to":"/query-language/functions/#less-than-less-than-or-equal-to-greater-than-and-greater-than-or-equal-to","/query-language/#uid":"/query-language/functions/#uid","/query-language/#uid-in":"/query-language/functions/#uid-in","/query-language/#has":"/query-language/functions/#has","/query-language/#geolocation":"/query-language/functions/#geolocation","/query-language/#mutations":"/query-language/functions/#mutations","/query-language/#query":"/query-language/functions/#query","/query-language/#near":"/query-language/functions/#near","/query-language/#within":"/query-language/functions/#within","/query-language/#contains":"/query-language/functions/#contains","/query-language/#intersects":"/query-language/functions/#intersects","/query-language/#connecting-filters":"/query-language/connecting-filters/","/query-language/#and-or-and-not":"/query-language/connecting-filters/#and-or-and-not","/query-language/#alias":"/query-language/alias","/query-language/#pagination":"/query-language/pagination","/query-language/#first":"/query-language/pagination/#first","/query-language/#offset":"/query-language/paginatio/n#offset","/query-language/#after":"/query-language/pagination/#after","/query-language/#count":"/query-language/count","/query-language/#sorting":"/query-language/sorting","/query-language/#multiple-query-blocks":"/query-language/multiple-query-blocks","/query-language/#var-blocks":"/query-language/multiple-query-blocks/#var-blocks","/query-language/#query-variables":"/query-language/query-variables/","/query-language/#value-variables":"/query-language/value-variables/","/query-language/#variable-propagation":"/query-language/value-variables/#variable-propagation","/query-language/#aggregation":"/query-language/aggregation/","/query-language/#min":"/query-language/aggregation/#min","/query-language/#usage-at-root-2":"/query-language/aggregation/#usage-at-root-2","/query-language/#usage-at-other-levels":"/query-language/aggregation/#usage-at-other-levels","/query-language/#max":"/query-language/aggregation/#max","/query-language/#usage-at-root-3":"/query-language/aggregation/#usage-at-root-3","/query-language/#usage-at-other-levels-1":"/query-language/aggregation/#usage-at-other-levels-1","/query-language/#sum-and-avg":"/query-language/aggregation/#sum-and-avg","/query-language/#usage-at-root-4":"/query-language/aggregation/#usage-at-root-4","/query-language/#usage-at-other-levels-2":"/query-language/aggregation/#usage-at-other-levels-2","/query-language/#aggregating-aggregates":"/query-language/aggregation/#aggregating-aggregates","/query-language/#math-on-value-variables":"/query-language/math-on-value-variables/","/query-language/#groupby":"/query-language/groupby/","/query-language/#expand-predicates":"/query-language/expand-predicates/","/query-language/#filtering-during-expand":"/query-language/expand-predicates/#filtering-during-expand","/query-language/#cascade-directive":"/query-language/cascade-directive/","/query-language/#normalize-directive":"/query-language/normalize-directive/","/query-language/#ignorereflex-directive":"/query-language/ignorereflex-directive/","/query-language/#debug":"/query-language/debug/","/query-language/#schema":"/query-language/schema/","/query-language/#schema-types":"/query-language/schema/#schema-types","/query-language/#scalar-types":"/query-language/schema/#scalar-types","/query-language/#uid-type":"/query-language/schema/#uid-type","/query-language/#adding-or-modifying-schema":"/query-language/schema/#adding-or-modifying-schema","/query-language/#indexes-in-background":"/query-language/schema/#indexes-in-background","/query-language/#http-api":"/query-language/schema/#http-api","/query-language/#grpc-api":"/query-language/schema/#grpc-api","/query-language/#predicate-name-rules":"/query-language/schema/#predicate-name-rules","/query-language/#allowed-special-characters":"/query-language/schema/#allowed-special-characters","/query-language/#forbidden-special-characters":"/query-language/schema/#forbidden-special-characters","/query-language/#predicates-i18n":"/query-language/schema/#predicates-i18n","/query-language/#upsert-directive":"/query-language/schema/#upsert-directive","/query-language/#noconflict-directive":"/query-language/schema/#noconflict-directive","/query-language/#rdf-types":"/query-language/schema/#rdf-types","/query-language/#extended-types":"/query-language/schema/#extended-types","/query-language/#password-type":"/query-language/schema/#password-type","/query-language/#indexing":"/query-language/schema/#indexing","/query-language/#string-indices":"/query-language/schema/#string-indices","/query-language/#datetime-indices":"/query-language/schema/#datetime-indices","/query-language/#sortable-indices":"/query-language/schema/#sortable-indices","/query-language/#count-index":"/query-language/schema/#count-index","/query-language/#list-type":"/query-language/schema/#list-type","/query-language/#filtering-on-list":"/query-language/schema/#filtering-on-list","/query-language/#reverse-edges":"/query-language/schema/#reverse-edges","/query-language/#querying-schema":"/query-language/schema/#querying-schema","/query-language/#type-system":"/query-language/type-system/","/query-language/#type-definition":"/query-language/schema/#type-definition","/query-language/#setting-the-type-of-a-node":"/query-language/schema/#setting-the-type-of-a-node","/query-language/#using-types-during-queries":"/query-language/schema/#using-types-during-queries","/query-language/#deleting-a-type":"/query-language/schema/#deleting-a-type","/query-language/#expand-queries-and-types":"/query-language/schema/#expand-queries-and-types","/query-language/#facets-edge-attributes":"/query-language/facets/","/query-language/#facets-on-scalar-predicates":"/query-language/facets/#facets-on-scalar-predicates","/query-language/#facets-i18n":"/query-language/facets/#facets-i18n","/query-language/#alias-with-facets":"/query-language/facets/#alias-with-facets","/query-language/#facets-on-uid-predicates":"/query-language/facets/#facets-on-uid-predicates","/query-language/#filtering-on-facets":"/query-language/facets/#filtering-on-facets","/query-language/#sorting-using-facets":"/query-language/facets/#sorting-using-facets","/query-language/#assigning-facet-values-to-a-variable":"/query-language/facets/#assigning-facet-values-to-a-variable","/query-language/#facets-and-variable-propagation":"/query-language/facets/#facets-and-variable-propagation","/query-language/#facets-and-aggregation":"/query-language/facets/#facets-and-aggregation","/query-language/#k-shortest-path-queries":"/query-language/k-shortest-path-queries/","/query-language/#recurse-query":"/query-language/recurse-query/","/query-language/#fragments":"/query-language/fragments/","/query-language/#graphql-variables":"/query-language/graphql-variables/","/query-language/#indexing-with-custom-tokenizers":"/query-language/indexing-custom-tokenizers/","/query-language/#caveats":"/query-language/indexing-custom-tokenizers/#caveats","/query-language/#implementing-a-plugin":"/query-language/indexing-custom-tokenizers/#implementing-a-plugin","/query-language/#building-the-plugin":"/query-language/indexing-custom-tokenizers/#building-the-plugin","/query-language/#running-dgraph-with-plugins":"/query-language/indexing-custom-tokenizers/#running-dgraph-with-plugins","/query-language/#adding-the-index-to-the-schema":"/query-language/indexing-custom-tokenizers/#adding-the-index-to-the-schema","/query-language/#using-the-index-in-queries":"/query-language/indexing-custom-tokenizers/#using-the-index-in-queries","/query-language/#examples":"/query-language/indexing-custom-tokenizers/#examples","/query-language/#unicode-characters":"/query-language/indexing-custom-tokenizers/#unicode-characters","/query-language/#cidr-range":"/query-language/indexing-custom-tokenizers/#cidr-range","/query-language/#anagram":"/query-language/indexing-custom-tokenizers/#anagram","/query-language/#integer-prime-factors":"/query-language/indexing-custom-tokenizers/#integer-prime-factors","/design-concepts/#can-we-do-pre-writes-only-on-leaders":"/design-concepts/transactions-faq/","/design-concepts/#edges":"/design-concepts/concepts/#edges","/design-concepts/#posting-list":"/design-concepts/concepts/#posting-list","/design-concepts/#badger":"/design-concepts/concepts/#badger","/design-concepts/#group":"/design-concepts/concepts/#group","/design-concepts/#replication-and-server-failure":"/design-concepts/concepts/#replication-and-server-failure","/design-concepts/#new-server-and-discovery":"/design-concepts/concepts/#new-server-and-discovery","/design-concepts/#write-ahead-logs":"/design-concepts/concepts/#write-ahead-logs","/design-concepts/#mutations":"/design-concepts/concepts/#mutations","/design-concepts/#queries":"/design-concepts/concepts/#queries","/design-concepts/#network-calls":"/design-concepts/concepts/#network-calls","/design-concepts/#worker":"/design-concepts/concepts/#worker","/design-concepts/#worker-pool":"/design-concepts/concepts/#worker-pool","/design-concepts/#protocol-buffers":"/design-concepts/concepts/#protocol-buffers","/design-concepts/#sql-nosql":"/design-concepts/minimizing-network-calls/#sql-nosql","/design-concepts/#dgraph":"/design-concepts/minimizing-network-calls/#dgraph","/design-concepts/#term":"/design-concepts/raft/#dgraph","/design-concepts/#server-states":"/design-concepts/raft/#server-states","/design-concepts/#communication":"/design-concepts/raft/#communication","/design-concepts/#log-entries":"/design-concepts/raft/#log-entries","/design-concepts/#voting":"/design-concepts/raft/#voting","/design-concepts/#cluster-membership":"/design-concepts/raft/#cluster-membership","/design-concepts/#log-compaction":"/design-concepts/raft/#log-compaction","/design-concepts/#clients":"/design-concepts/raft/#clients","/design-concepts/#linearizable-semantics":"/design-concepts/raft/#linearizable-semantics","/design-concepts/#read-only-queries":"/design-concepts/raft/#read-only-queries","/mutations/#deletion-of-non-list-predicates":"/mutations/delete/#deletion-of-non-list-predicates","/mutations/#setting-literal-values":"/mutations/json-mutation-format/#setting-literal-values","/mutations/#language-support":"/mutations/json-mutation-format/#language-support","/mutations/#geolocation-support":"/mutations/json-mutation-format/#geolocation-support","/mutations/#referencing-existing-nodes":"/mutations/json-mutation-format/#referencing-existing-nodes","/mutations/#edges-between-nodes":"/mutations/json-mutation-format/#edges-between-nodes","/mutations/#deleting-literal-values":"/mutations/json-mutation-format/#deleting-literal-values","/mutations/#deleting-edges":"/mutations/json-mutation-format/#deleting-edges","/mutations/#facets":"/mutations/json-mutation-format/#facets","/mutations/#deleting-facets":"/mutations/json-mutation-format/#deleting-facets","/mutations/#creating-a-list-with-json-and-interacting-with":"/mutations/json-mutation-format/#creating-a-list-with-json-and-interacting-with","/mutations/#facets-in-list-type-with-json":"/mutations/json-mutation-format/#facets-in-list-type-with-json","/mutations/#specifying-multiple-operations":"/mutations/json-mutation-format/#specifying-multiple-operations","/mutations/#json-syntax-using-raw-http-or-ratel-ui":"/mutations/json-mutation-format/#json-syntax-using-raw-http-or-ratel-ui","/mutations/#using-json-operations-via-curl":"/mutations/json-mutation-format/#using-json-operations-via-curl","/mutations/#uid-function":"/mutations/upsert-block/#uid-function","/mutations/#val-function":"/mutations/upsert-block/#val-function","/mutations/#example-of-uid-function":"/mutations/upsert-block/#example-of-uid-function","/mutations/#example-of-val-function":"/mutations/upsert-block/#example-of-val-function","/mutations/#bulk-delete-example":"/mutations/upsert-block/#bulk-delete-example","/mutations/#example-of-conditional-upsert":"/mutations/conditional-upsert/#example-of-conditional-upsert","/mutations/#example-of-multiple-mutation-blocks":"/mutations/conditional-upsert/#example-of-multiple-mutation-blocks","/enterprise-features/#configure-backup":"/enterprise-features/binary-backups/#configure-backup","/enterprise-features/#configure-amazon-s3-credentials":"/enterprise-features/binary-backups/#configure-amazon-s3-credentials","/enterprise-features/#configure-minio-credentials":"/enterprise-features/binary-backups/#configure-minio-credentials","/enterprise-features/#create-a-backup":"/enterprise-features/binary-backups/#create-a-backup","/enterprise-features/#backup-to-amazon-s3":"/enterprise-features/binary-backups/#backup-to-amazon-s3","/enterprise-features/#backup-to-minio":"/enterprise-features/binary-backups/#backup-to-minio","/enterprise-features/#backup-to-minio":"/enterprise-features/binary-backups/#backup-to-minio","/enterprise-features/#backup-to-google-cloud-storage-via-minio-gateway":"/enterprise-features/binary-backups/#backup-to-google-cloud-storage-via-minio-gateway","/enterprise-features/#test-using-minio-browser":"/enterprise-features/binary-backups/#test-using-minio-browser","/enterprise-features/#test-using-minio-client":"/enterprise-features/binary-backups/#test-using-minio-client","/enterprise-features/#disabling-https-for-s3-and-minio-backups":"/enterprise-features/binary-backups/#disabling-https-for-s3-and-minio-backups","/enterprise-features/#overriding-credentials":"/enterprise-features/binary-backups/#overriding-credentials","/enterprise-features/#backup-to-nfs":"/enterprise-features/binary-backups/#backup-to-nfs","/enterprise-features/#forcing-a-full-backup":"/enterprise-features/binary-backups/#forcing-a-full-backup","/enterprise-features/#encrypted-backups":"/enterprise-features/binary-backups/#encrypted-backups","/enterprise-features/#new-flag-“encrypted”-in-manifest.json":"/enterprise-features/binary-backups/#new-flag-“encrypted”-in-manifest.json","/enterprise-features/#aes-and-chaining-with-gzip":"/enterprise-features/binary-backups/#aes-and-chaining-with-gzip","/enterprise-features/#backup":"/enterprise-features/binary-backups/#backup","/enterprise-features/#restore-from-backup":"/enterprise-features/binary-backups/#restore-from-backup","/enterprise-features/#restore-from-amazon-s3":"/enterprise-features/binary-backups/#restore-from-amazon-s3","/enterprise-features/#restore-from-minio":"/enterprise-features/binary-backups/#restore-from-minio","/enterprise-features/#restore-from-local-directory-or-nfs":"/enterprise-features/binary-backups/#restore-from-local-directory-or-nfs","/enterprise-features/#restore-and-update-timestamp":"/enterprise-features/binary-backups/#restore-and-update-timestamp","/enterprise-features/#turn-on-acls":"/enterprise-features/access-control-lists/#turn-on-acls","/enterprise-features/#set-up-acl-rules":"/enterprise-features/access-control-lists/#set-up-acl-rules","/enterprise-features/#using-graphql-admin-api":"/enterprise-features/access-control-lists/#using-graphql-admin-api","/enterprise-features/#retrieve-users-and-groups-information":"/enterprise-features/access-control-lists/#retrieve-users-and-groups-information","/enterprise-features/#using-a-graphql-tool":"/enterprise-features/access-control-lists/#using-a-graphql-tool","/enterprise-features/#access-data-using-a-client":"/enterprise-features/access-control-lists/#access-data-using-a-client","/enterprise-features/#access-data-using-the-graphql-api":"/enterprise-features/access-control-lists/#access-data-using-the-graphql-api","/enterprise-features/#reset-groot-password":"/enterprise-features/access-control-lists/#reset-groot-password","/enterprise-features/#set-up-encryption":"/enterprise-features/encryption-at-rest/#set-up-encryption","/enterprise-features/#turn-on-encryption":"/enterprise-features/encryption-at-rest/#turn-on-encryption","/enterprise-features/#turn-off-encryption":"/enterprise-features/encryption-at-rest/#turn-off-encryption","/enterprise-features/#change-encryption-key":"/enterprise-features/encryption-at-rest/#change-encryption-key","/howto/#metrics-information":"/howto/retrieving-debug-information/#metrics-information","/howto/#profiling-information":"/howto/retrieving-debug-information/#profiling-information","/howto/#cpu-profile":"/howto/retrieving-debug-information/#cpu-profile","/howto/#memory-profile":"/howto/retrieving-debug-information/#memory-profile","/howto/#block-profile":"/howto/retrieving-debug-information/#block-profile","/howto/#goroutine-stack":"/howto/retrieving-debug-information/#goroutine-stack","/howto/#example-usage":"/howto/using-debug-tool/#example-usage","/howto/#debug-tool-output":"/howto/using-debug-tool/#debug-tool-output","/howto/#key-lookup":"/howto/using-debug-tool/#key-lookup","/howto/#key-history":"/howto/using-debug-tool/#key-history","/howto/#basic-integration":"/howto/dgraph-sentry-integration/#basic-integration","/howto/#data-handling":"/howto/dgraph-sentry-integration/#data-handling","/howto/#increment-tool-output":"/howto/using-increment-tool/#increment-tool-output","/howto/#download-zip":"/howto/load-balancing-nginx/#download-zip","/howto/#start-dgraph-cluster":"/howto/load-balancing-nginx/#start-dgraph-cluster","/howto/#use-the-increment-tool-to-start-a-grpc-lb":"/howto/load-balancing-nginx/#use-the-increment-tool-to-start-a-grpc-lb","/howto/#check-logs":"/howto/load-balancing-nginx/#check-logs","/howto/#upsert-procedure":"/howto/upserts/#upsert-procedure","/howto/#upsert-block":"/howto/upserts/#upsert-block","/howto/#conflicts":"/howto/upserts/#conflicts","/howto/#schema-types-scalar-uid-and-list-uid":"/howto/migrate-dgraph-1-1/#schema-types-scalar-uid-and-list-uid","/howto/#type-system":"/howto/migrate-dgraph-1-1/#type-system","/howto/#live-loader-and-bulk-loader-command-line-flags":"/howto/migrate-dgraph-1-1/#live-loader-and-bulk-loader-command-line-flags","/howto/#http-api":"/howto/migrate-dgraph-1-1/#http-api"},urlSplit,origPath,redirectPaths=["clients","query-language","mutations","deploy","enterprise-features","howto","design-concepts"],pathSplit=document.URL.split("/");redirectPaths.includes(pathSplit[pathSplit.length-2])&&(urlSplit=pathSplit[pathSplit.length-1].split("#"),origPath="/"+pathSplit[pathSplit.length-2]+"/#"+urlSplit[1],origPath in subPaths?(loc=""+subPaths[origPath],window.location.replace(loc)):urlSplit[1]&&(loc=""+pathSplit.slice(4,pathSplit.length-1).join("/")+"/#"+urlSplit[1],window.location.replace(loc)))</script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name=referrer content="no-referrer-when-downgrade"><meta name=generator content="Hugo 0.118.2"><meta name=description content><link rel=canonical href=/query-language/indexing-custom-tokenizers/><link rel=apple-touch-icon sizes=57x57 href=/images/favicons/apple-touch-icon-57x57.png><link rel=apple-touch-icon sizes=60x60 href=/images/favicons/apple-touch-icon-60x60.png><link rel=apple-touch-icon sizes=72x72 href=/images/favicons/apple-touch-icon-72x72.png><link rel=apple-touch-icon sizes=76x76 href=/images/favicons/apple-touch-icon-76x76.png><link rel=apple-touch-icon sizes=114x114 href=/images/favicons/apple-touch-icon-114x114.png><link rel=apple-touch-icon sizes=120x120 href=/images/favicons/apple-touch-icon-120x120.png><link rel=apple-touch-icon sizes=144x144 href=/images/favicons/apple-touch-icon-144x144.png><link rel=apple-touch-icon sizes=152x152 href=/images/favicons/apple-touch-icon-152x152.png><link rel=apple-touch-icon sizes=180x180 href=/images/favicons/apple-touch-icon-180x180.png><link rel=icon type=image/png href=/images/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/images/favicons/android-chrome-192x192.png sizes=192x192><link rel=icon type=image/png href=/images/favicons/favicon-194x194.png sizes=194x194><link rel=icon type=image/png href=/images/favicons/favicon-96x96.png sizes=96x96><link rel=icon type=image/png href=/images/favicons/favicon-16x16.png sizes=16x16><link rel=manifest href=/images/favicons/manifest.json><link rel=mask-icon href=/images/favicons/safari-pinned-tab.svg color=#fe2c06><link rel="shortcut icon" href=/images/favicons/favicon.ico><link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/styles/default.min.css><script src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/highlight.min.js></script>
<script async src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/languages/go.min.js></script>
<script async src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/languages/java.min.js integrity="sha256-RyOs5MjQ+Ef9DQrPHp4QGr2tcNjxLh6mCkkW+sS4doU=" crossorigin=anonymous></script>
<script src=//code.jquery.com/jquery-3.2.1.min.js integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin=anonymous></script>
<script src=//cdnjs.cloudflare.com/ajax/libs/codemirror/5.25.0/codemirror.js integrity="sha256-x3BtPVERvw1ozPlwivuFLZoViFCeAAs1Gt6SxEedmo8=" crossorigin=anonymous></script>
<link href=//cdnjs.cloudflare.com/ajax/libs/codemirror/5.25.0/codemirror.css rel=stylesheet integrity="sha256-7sZe9dsqyNZC9Mk+WPRB7nVvPPPXyorzm2QKqlgXC4k=" crossorigin=anonymous><script async src=//cdnjs.cloudflare.com/ajax/libs/codemirror/5.25.0/addon/edit/closebrackets.min.js integrity="sha256-qhu2a7DSpQaammMaLw1iruxBpxmgdw8mdQaQWQUokcY=" crossorigin=anonymous></script>
<script async src=//cdnjs.cloudflare.com/ajax/libs/codemirror/5.25.0/mode/javascript/javascript.min.js integrity="sha256-7Bdg/UdDMmHDPafpQDYZNPCEbnRP7eAvu+2hEoqRCXs=" crossorigin=anonymous></script><title>Indexing with Custom Tokenizers - Query language</title><link href=/css/theme.css?6a79ff0832398fa8541cbaef6b6dd556 rel=stylesheet><link href=/css/runnable.css?46648956d99faa2e057d109b9f2a52e6 rel=stylesheet><link href=/css/tabs.css?035edc32762cb7973b740e3067101ced rel=stylesheet><link href=//maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css rel=stylesheet integrity=sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ crossorigin=anonymous><script src=//cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js integrity=sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb crossorigin=anonymous></script>
<script src=//maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js integrity=sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn crossorigin=anonymous></script>
<link href="//fonts.googleapis.com/css?family=Lato:400,700" rel=stylesheet><link href=//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css rel=stylesheet integrity=sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN crossorigin=anonymous><link href=https://cdn.lineicons.com/2.0/LineIcons.css rel=stylesheet crossorigin=anonymous><link rel=stylesheet href=//cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css><script>!function(){var t,n,e=window.analytics=window.analytics||[];if(!e.initialize)if(e.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{e.invoked=!0,e.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on","addSourceMiddleware","addIntegrationMiddleware","setAnonymousId","addDestinationMiddleware"],e.factory=function(t){return function(){var n=Array.prototype.slice.call(arguments);return n.unshift(t),e.push(n),e}};for(t=0;t<e.methods.length;t++)n=e.methods[t],e[n]=e.factory(n);e.load=function(t,n){var o,s=document.createElement("script");s.type="text/javascript",s.async=!0,s.src="https://cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js",o=document.getElementsByTagName("script")[0],o.parentNode.insertBefore(s,o),e._loadOptions=n},e._writeKey="aQlf725vSBKhpQnINiGBc6rCtFyVCiAP",e.SNIPPET_VERSION="4.13.2",e.load("aQlf725vSBKhpQnINiGBc6rCtFyVCiAP"),e.page(),document.addEventListener("DOMContentLoaded",()=>{const t=document.querySelectorAll("a");t.forEach(t=>e.trackLink(t,"Click",{id:t.id,to:t.href,text:t.innerText}))})}}()</script></head><body><nav id=header><div class=header-left><div><a href=https://libremfg.com class=brand><img src=/images/rhize-logo.png alt=RHIZE class=logo></a><div class=logo-tagline><span>Documentation</span></div></div></div><div class=header-right><div style=margin-top:10px><div class="menu-search align-middle"><div class=menu-search-inner><input type=search class="form-control form-control-sm" id=algolia-doc-search placeholder="Search documentation" aria-label="Search docs" autocomplete=off></div></div></div><div><ul class=menu><li><a href=https://libremfg.com/features-gql target=_blank>Home</a></li><li><a href=https://discord.gg/5rPvv2Vy target=_blank>Community</a></li><li><a href=https://github.com/libremfg/libremfg.github.io target=_blank>GitHub</a></li></ul></div></div><a href=# id=sidebar-toggle><i class="fa fa-bars"></i></a></nav><aside id=sidebar><div class=menu-header></div><ul class=topics><li class="topic main-topic children"><a id=datahub href=#>DataHub</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=/datahub/overview/>Overview</a></li><li class="topic sub-topic"><a href=/datahub/isa-95-data-model/>ISA 95 Data Model</a></li><li class="topic sub-topic"><a href=/datahub/streaming-data/>Streaming Data</a></li></ul></li><li class="topic main-topic"><a href=/>Home</a></li><li class="topic main-topic"><a href=/dgraph-overview/>Dgraph Overview</a></li><li class="topic main-topic children"><a id=architecture href=#>Architecture</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=/architecture/overview/>Overview</a></li><li class="topic sub-topic"><a href=/architecture/realtime-database-architecture/>Realtime Database</a></li><li class="topic sub-topic"><a href=/architecture/data-hub/>Data Hub Architecture</a></li><li class="topic sub-topic"><a href=/architecture/event-driven-architecture/>Event Driven Architecture</a></li><li class="topic sub-topic"><a href=/architecture/business-process-orchestration/>Business Process Orchestration</a></li></ul></li><li class="topic main-topic children"><a id=bpmn href=#>BPMN</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=#>Events</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=/bpmn/events/overview/>Events Overview</a></li><li class="topic sub-topic"><a href=/bpmn/events/message/>Message Event</a></li><li class="topic sub-topic"><a href=/bpmn/events/timer/>Timer Event</a></li><li class="topic sub-topic"><a href=/bpmn/events/signal/>Signal Event</a></li><li class="topic sub-topic"><a href=/bpmn/events/escalation/>Escalation Event</a></li><li class="topic sub-topic"><a href=/bpmn/events/error/>Error Event</a></li><li class="topic sub-topic"><a href=/bpmn/events/conditional/>Conditional Event</a></li><li class="topic sub-topic"><a href=/bpmn/events/compensation/>Compensation Event</a></li></ul></li><li class="topic sub-topic"><a href=#>Gateways</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=/bpmn/gateways/overview/>Gateway Overview</a></li><li class="topic sub-topic"><a href=/bpmn/gateways/parallel/>Parallel Gateway</a></li><li class="topic sub-topic"><a href=/bpmn/gateways/inclusive/>Inclusive Gateway</a></li><li class="topic sub-topic"><a href=/bpmn/gateways/complex/>Complex Gateway</a></li><li class="topic sub-topic"><a href=/bpmn/gateways/event-based/>Event Based Gateway</a></li></ul></li><li class="topic sub-topic"><a href=#>Tasks</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=/bpmn/tasks/overview/>Tasks Overview</a></li></ul></li></ul></li><li class="topic main-topic children"><a id=graphql href=#>GraphQL</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=/graphql/overview/>Overview</a></li><li class="topic sub-topic"><a href=/graphql/quick-start/>Quick Start</a></li><li class="topic sub-topic"><a href=/graphql/how-dgraph-graphql-works/>How GraphQL works in Dgraph</a></li><li class="topic sub-topic"><a href=#>To-Do List App Tutorial</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=/graphql/todo-app-tutorial/todo-overview/>Overview</a></li><li class="topic sub-topic"><a href=/graphql/todo-app-tutorial/todo-schema-design/>Schema Design</a></li><li class="topic sub-topic"><a href=/graphql/todo-app-tutorial/todo-ui/>Creating a Basic UI</a></li><li class="topic sub-topic"><a href=/graphql/todo-app-tutorial/todo-auth-rules/>Authorization Rules</a></li><li class="topic sub-topic"><a href=/graphql/todo-app-tutorial/todo-auth0-jwt/>Using Auth0</a></li><li class="topic sub-topic"><a href=/graphql/todo-app-tutorial/todo-firebase-jwt/>Using Firebase Authentication</a></li><li class="topic sub-topic"><a href=/graphql/todo-app-tutorial/deploy/>Deploying on Dgraph Cloud</a></li></ul></li><li class="topic sub-topic"><a href=#>Authorization</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=/graphql/authorization/authorization-overview/>KeyCloak Integration</a></li><li class="topic sub-topic"><a href=/graphql/authorization/directive/>The @auth Directive</a></li><li class="topic sub-topic"><a href=/graphql/authorization/mutations/>Mutations</a></li></ul></li><li class="topic sub-topic"><a href=#>API</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=/graphql/api/api-overview/>Overview</a></li><li class="topic sub-topic"><a href=/graphql/api/requests/>Requests and Responses</a></li><li class="topic sub-topic"><a href=/graphql/api/variables/>GraphQL Variables</a></li><li class="topic sub-topic"><a href=/graphql/api/fragments/>GraphQL Fragments</a></li><li class="topic sub-topic"><a href=/graphql/api/multiples/>Multiple GraphQL Operations in a Request</a></li><li class="topic sub-topic"><a href=/graphql/api/errors/>GraphQL Errors</a></li></ul></li><li class="topic sub-topic"><a href=#>Schema</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=/graphql/schema/schema-overview/>Overview</a></li><li class="topic sub-topic"><a href=/graphql/schema/reserved/>Reserved Names</a></li><li class="topic sub-topic"><a href=/graphql/schema/migration/>Schema Migration</a></li><li class="topic sub-topic"><a href=/graphql/schema/types/>Types</a></li><li class="topic sub-topic"><a href=/graphql/schema/ids/>IDs</a></li><li class="topic sub-topic"><a href=/graphql/schema/graph-links/>Links in the Graph</a></li><li class="topic sub-topic"><a href=/graphql/schema/search/>Search and Filtering</a></li><li class="topic sub-topic"><a href=/graphql/schema/generate/>The @generate Directive</a></li><li class="topic sub-topic"><a href=/graphql/schema/documentation/>Documentation and Comments</a></li><li class="topic sub-topic"><a href=/graphql/schema/deprecated/>Deprecation</a></li><li class="topic sub-topic"><a href=/graphql/schema/dgraph-schema/>Dgraph Schema Fragment</a></li><li class="topic sub-topic"><a href=/graphql/schema/default/>@default Directive</a></li><li class="topic sub-topic"><a href=/graphql/schema/primarykey/>@primaryKey Directive</a></li></ul></li><li class="topic sub-topic"><a href=#>Queries</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=/graphql/queries/queries-overview/>Overview</a></li><li class="topic sub-topic"><a href=/graphql/queries/search-filtering/>Search and Filtering</a></li><li class="topic sub-topic"><a href=/graphql/queries/aggregate/>Aggregate Queries</a></li><li class="topic sub-topic"><a href=/graphql/queries/persistent-queries/>Persistent Queries</a></li><li class="topic sub-topic"><a href=/graphql/queries/and-or-not/>And, Or and Not</a></li><li class="topic sub-topic"><a href=/graphql/queries/cached-results/>Cached Results</a></li><li class="topic sub-topic"><a href=/graphql/queries/order-page/>Order and Pagination</a></li><li class="topic sub-topic"><a href=/graphql/queries/cascade/>@cascade Directive</a></li><li class="topic sub-topic"><a href=/graphql/queries/skip-include/>@skip and @include Directives</a></li></ul></li><li class="topic sub-topic"><a href=#>Mutations</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=/graphql/mutations/mutations-overview/>Overview</a></li><li class="topic sub-topic"><a href=/graphql/mutations/add/>Add</a></li><li class="topic sub-topic"><a href=/graphql/mutations/upsert/>Upsert</a></li><li class="topic sub-topic"><a href=/graphql/mutations/update/>Update</a></li><li class="topic sub-topic"><a href=/graphql/mutations/delete/>Delete</a></li><li class="topic sub-topic"><a href=/graphql/mutations/deep/>Deep</a></li></ul></li><li class="topic sub-topic"><a href=/graphql/subscriptions/>Subscriptions</a></li><li class="topic sub-topic"><a href=#>Custom Resolvers</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=/graphql/custom/custom-overview/>Overview</a></li><li class="topic sub-topic"><a href=/graphql/custom/directive/>The @custom Directive</a></li><li class="topic sub-topic"><a href=/graphql/custom/query/>Custom Queries</a></li><li class="topic sub-topic"><a href=/graphql/custom/mutation/>Custom Mutations</a></li><li class="topic sub-topic"><a href=/graphql/custom/field/>Custom Fields</a></li><li class="topic sub-topic"><a href=/graphql/custom/dql/>Custom DQL</a></li></ul></li><li class="topic sub-topic"><a href=#>Lambda Resolvers</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=/graphql/lambda/overview/>Overview</a></li><li class="topic sub-topic"><a href=/graphql/lambda/field/>Lambda Fields</a></li><li class="topic sub-topic"><a href=/graphql/lambda/query/>Lambda Queries</a></li><li class="topic sub-topic"><a href=/graphql/lambda/mutation/>Lambda Mutations</a></li><li class="topic sub-topic"><a href=/graphql/lambda/webhook/>Lambda Webhooks</a></li><li class="topic sub-topic"><a href=/graphql/lambda/server/>Lambda Server</a></li></ul></li><li class="topic sub-topic"><a href=/graphql/directives/>Directives</a></li><li class="topic sub-topic"><a href=/graphql/admin/>Administrative API</a></li><li class="topic sub-topic"><a href=/graphql/dgraph/>GraphQL on Existing Dgraph</a></li><li class="topic sub-topic"><a href=/graphql/federation/>Apollo Federation</a></li></ul></li><li class="topic main-topic children"><a id=deploy-and-manage href=#>Deploy and Manage</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=/deploy/overview/>Deployment and Management Overview</a></li><li class="topic sub-topic"><a href=/deploy/download/>Download Dgraph</a></li><li class="topic sub-topic"><a href=/deploy/config/>Configuration</a></li><li class="topic sub-topic"><a href=/deploy/dgraph-zero/>More about Dgraph Zero</a></li><li class="topic sub-topic"><a href=/deploy/dgraph-alpha/>More about Dgraph Alpha</a></li><li class="topic sub-topic"><a href=/deploy/single-host-setup/>Single Host Setup</a></li><li class="topic sub-topic"><a href=/deploy/multi-host-setup/>Multi-Host Setup</a></li><li class="topic sub-topic"><a href=/deploy/kubernetes/>Using Kubernetes</a></li><li class="topic sub-topic"><a href=/deploy/cluster-setup/>Cluster Setup</a></li><li class="topic sub-topic"><a href=/deploy/cluster-checklist/>Cluster Checklist</a></li><li class="topic sub-topic"><a href=/deploy/production-checklist/>Production Checklist</a></li><li class="topic sub-topic"><a href=#>Administration</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=/deploy/dgraph-administration/>Dgraph Administration</a></li><li class="topic sub-topic"><a href=/deploy/log-format/>Logging</a></li><li class="topic sub-topic"><a href=/deploy/ludicrous-mode/>Ludicrous Mode</a></li><li class="topic sub-topic"><a href=/deploy/monitoring/>Monitoring</a></li><li class="topic sub-topic"><a href=/deploy/metrics/>Metrics</a></li><li class="topic sub-topic"><a href=/deploy/tracing/>Tracing</a></li><li class="topic sub-topic"><a href=/deploy/data-compression/>Data compression on Disk</a></li></ul></li><li class="topic sub-topic"><a href=#>Fast Data Loading</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=/deploy/fast-data-loading/overview/>Overview</a></li><li class="topic sub-topic"><a href=/deploy/fast-data-loading/bulk-loader/>Bulk Loader</a></li><li class="topic sub-topic"><a href=/deploy/fast-data-loading/live-loader/>Live Loader</a></li></ul></li><li class="topic sub-topic"><a href=#>Security</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=/deploy/ports-usage/>Ports Usage</a></li><li class="topic sub-topic"><a href=/deploy/tls-configuration/>TLS Configuration</a></li></ul></li><li class="topic sub-topic"><a href=/deploy/decrypt/>Data Decryption</a></li><li class="topic sub-topic"><a href=/deploy/cli-command-reference/>Dgraph CLI Reference</a></li><li class="topic sub-topic"><a href=/deploy/troubleshooting/>Troubleshooting</a></li></ul></li><li class="topic main-topic children"><a id=migration href=#>Migration</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=/migration/loading-csv-data/>Loading CSV Data</a></li><li class="topic sub-topic"><a href=/migration/migrate-tool/>Migration Tool</a></li><li class="topic sub-topic"><a href=/migration/migrate-dgraph-1-1/>Migrate from Dgraph v1.0</a></li><li class="topic sub-topic"><a href=/migration/dgraph-compared-to-other-databases/>Dgraph Compared to Other Databases</a></li></ul></li><li class="topic main-topic"><a href=/faq/>FAQ</a></li><li class="topic main-topic children"><a id=isa-95 href=#>ISA 95</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=/isa95/operationsevents/>Operations Events</a></li></ul></li><li class="topic main-topic children"><a id=how-to-guides href=#>How To Guides</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=/howto/retrieving-debug-information/>Retrieving Debug Information</a></li><li class="topic sub-topic"><a href=/howto/completion/>Shell Completion</a></li><li class="topic sub-topic"><a href=/howto/using-debug-tool/>Using the Debug Tool</a></li><li class="topic sub-topic"><a href=/howto/dgraph-sentry-integration/>Using the Dgraph Sentry Integration</a></li><li class="topic sub-topic"><a href=/howto/using-increment-tool/>Using the Increment Tool</a></li><li class="topic sub-topic"><a href=/howto/giving-nodes-type/>Giving Nodes a Type</a></li><li class="topic sub-topic"><a href=/howto/login-system/>A Simple Login System</a></li><li class="topic sub-topic"><a href=/howto/load-balancing-nginx/>Load Balancing Queries with NGINX</a></li><li class="topic sub-topic"><a href=/howto/upserts/>Upserts</a></li><li class="topic sub-topic"><a href=/howto/jepsen-tests/>Run Jepsen Tests</a></li><li class="topic sub-topic"><a href=/howto/lambda-webhooks-example/>Lambda Webhooks Example</a></li></ul></li><li class="topic main-topic children"><a id=design-concepts href=#>Design Concepts</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=/design-concepts/transactions-faq/>Transactions: FAQ</a></li><li class="topic sub-topic"><a href=/design-concepts/consistency-model/>Consistency Model</a></li><li class="topic sub-topic"><a href=/design-concepts/concepts/>Concepts</a></li><li class="topic sub-topic"><a href=/design-concepts/minimizing-network-calls/>How Dgraph Minimizes Network Calls</a></li><li class="topic sub-topic"><a href=/design-concepts/raft/>RAFT</a></li></ul></li><li class="topic main-topic"><a href=/releases/>Releases</a></li><li class="topic main-topic children active"><a id=dql href=#>dql</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=/get-started/>Get Started</a></li><li class="topic sub-topic"><a href=/tutorials/>Tutorials</a></li><li class="topic sub-topic active"><a href=#>Query Language Reference</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=/query-language/graphql-fundamentals/>DQL Fundamentals</a></li><li class="topic sub-topic"><a href=/query-language/functions/>Functions</a></li><li class="topic sub-topic"><a href=/query-language/connecting-filters/>Connecting Filters</a></li><li class="topic sub-topic"><a href=/query-language/alias/>Aliases</a></li><li class="topic sub-topic"><a href=/query-language/pagination/>Pagination in DQL</a></li><li class="topic sub-topic"><a href=/query-language/count/>Count</a></li><li class="topic sub-topic"><a href=/query-language/sorting/>Sorting</a></li><li class="topic sub-topic"><a href=/query-language/multiple-query-blocks/>Multiple Query Blocks</a></li><li class="topic sub-topic"><a href=/query-language/query-variables/>Query Variables</a></li><li class="topic sub-topic"><a href=/query-language/value-variables/>Value Variables</a></li><li class="topic sub-topic"><a href=/query-language/aggregation/>Aggregation</a></li><li class="topic sub-topic"><a href=/query-language/math-on-value-variables/>Math on Value Variables</a></li><li class="topic sub-topic"><a href=/query-language/groupby/>GroupBy</a></li><li class="topic sub-topic"><a href=/query-language/expand-predicates/>Expand Predicates</a></li><li class="topic sub-topic"><a href=/query-language/cascade-directive/>Cascade Directive</a></li><li class="topic sub-topic"><a href=/query-language/normalize-directive/>@normalize Directive</a></li><li class="topic sub-topic"><a href=/query-language/ignorereflex-directive/>@ignorereflex Directive</a></li><li class="topic sub-topic"><a href=/query-language/debug/>Debug</a></li><li class="topic sub-topic"><a href=/query-language/schema/>Schemas in DQL</a></li><li class="topic sub-topic"><a href=/query-language/type-system/>Type System</a></li><li class="topic sub-topic"><a href=/query-language/facets/>Facets and Edge Attributes</a></li><li class="topic sub-topic"><a href=/query-language/kshortest-path-quries/>Shortest Path Queries</a></li><li class="topic sub-topic"><a href=/query-language/recurse-query/>Recurse Query</a></li><li class="topic sub-topic"><a href=/query-language/fragments/>Fragments</a></li><li class="topic sub-topic"><a href=/query-language/graphql-variables/>GraphQL Variables</a></li><li class="topic sub-topic active"><a href=/query-language/indexing-custom-tokenizers/>Indexing with Custom Tokenizers</a></li></ul></li><li class="topic sub-topic"><a href=/tips/>Tips and Tricks</a></li><li class="topic sub-topic"><a href=#>Mutations</a><div class=arrow-down></div><ul class=sub-topics><li class="topic sub-topic"><a href=/mutations/triples/>Triples</a></li><li class="topic sub-topic"><a href=/mutations/blank-nodes/>Blank Nodes and UIDs</a></li><li class="topic sub-topic"><a href=/mutations/external-ids/>External IDs</a></li><li class="topic sub-topic"><a href=/mutations/external-ids-upsert-block/>External IDs and Upsert Block</a></li><li class="topic sub-topic"><a href=/mutations/language-rdf-types/>Language and RDF Types</a></li><li class="topic sub-topic"><a href=/mutations/batch-mutations/>Batch Mutations</a></li><li class="topic sub-topic"><a href=/mutations/delete/>Delete</a></li><li class="topic sub-topic"><a href=/mutations/facets-in-list-type-with-rdf/>Facet Lists in RDF</a></li><li class="topic sub-topic"><a href=/mutations/mutations-using-curl/>Mutations Using cURL</a></li><li class="topic sub-topic"><a href=/mutations/json-mutation-format/>JSON Mutation Format</a></li><li class="topic sub-topic"><a href=/mutations/upsert-block/>Upsert Blocks</a></li><li class="topic sub-topic"><a href=/mutations/conditional-upsert/>Conditional Upsert</a></li><li class="topic sub-topic"><a href=/mutations/reverse-edges/>Reverse Edges</a></li></ul></li></ul></li></ul><ul class=sidebar-menu><li><a href=https://dgraph.io/ target=_blank>Home</a></li><li><a href=https://discuss.dgraph.io/ target=_blank>Community</a></li><li><a href=https://github.com/dgraph-io/dgraph target=_blank>GitHub</a></li></ul></aside><main class=content-wrapper><div class=content><div class=top-toc><nav id=TableOfContents><ul><li><a href=#caveats>Caveats</a></li><li><a href=#implementing-a-plugin>Implementing a plugin</a></li><li><a href=#building-the-plugin>Building the plugin</a></li><li><a href=#running-dgraph-with-plugins>Running Dgraph with plugins</a></li><li><a href=#adding-the-index-to-the-schema>Adding the index to the schema</a></li><li><a href=#using-the-index-in-queries>Using the index in queries</a></li><li><a href=#examples>Examples</a><ul><li><a href=#unicode-characters>Unicode Characters</a></li><li><a href=#cidr-range>CIDR Range</a></li><li><a href=#anagram>Anagram</a></li><li><a href=#integer-prime-factors>Integer prime factors</a></li></ul></li></ul></nav></div><article><a class=question-btn target=_blank href=https://discord.gg/5rPvv2Vy><i class="fa fa-question-circle"></i> Ask a Question</a><h1 class=post-title>Indexing with Custom Tokenizers</h1><div><p>Dgraph comes with a large toolkit of builtin indexes, but sometimes for niche
use cases they&rsquo;re not always enough.</p><p>Dgraph allows you to implement custom tokenizers via a plugin system in order
to fill the gaps.</p><h2 id=caveats>Caveats</h2><p>The plugin system uses Go&rsquo;s <a href=https://golang.org/pkg/plugin/><code>pkg/plugin</code></a>.
This brings some restrictions to how plugins can be used.</p><ul><li><p>Plugins must be written in Go.</p></li><li><p>As of Go 1.9, <code>pkg/plugin</code> only works on Linux. Therefore, plugins will only
work on Dgraph instances deployed in a Linux environment.</p></li><li><p>The version of Go used to compile the plugin should be the same as the version
of Go used to compile Dgraph itself. Dgraph always uses the latest version of
Go (and so should you!).</p></li></ul><h2 id=implementing-a-plugin>Implementing a plugin</h2><div class="notices note"><span class=type>Note</span> You should consider Go&rsquo;s <a href=https://golang.org/pkg/plugin/>plugin</a> documentation
to be supplementary to the documentation provided here.</div><p>Plugins are implemented as their own main package. They must export a
particular symbol that allows Dgraph to hook into the custom logic the plugin
provides.</p><p>The plugin must export a symbol named <code>Tokenizer</code>. The type of the symbol must
be <code>func() interface{}</code>. When the function is called the result returned should
be a value that implements the following interface:</p><pre tabindex=0><code>type PluginTokenizer interface {
    // Name is the name of the tokenizer. It should be unique among all
    // builtin tokenizers and other custom tokenizers. It identifies the
    // tokenizer when an index is set in the schema and when search/filter
    // is used in queries.
    Name() string

    // Identifier is a byte that uniquely identifiers the tokenizer.
    // Bytes in the range 0x80 to 0xff (inclusive) are reserved for
    // custom tokenizers.
    Identifier() byte

    // Type is a string representing the type of data that is to be
    // tokenized. This must match the schema type of the predicate
    // being indexed. Allowable values are shown in the table below.
    Type() string

    // Tokens should implement the tokenization logic. The input is
    // the value to be tokenized, and will always have a concrete type
    // corresponding to Type(). The return value should be a list of
    // the tokens generated.
    Tokens(interface{}) ([]string, error)
}
</code></pre><p>The return value of <code>Type()</code> corresponds to the concrete input type of
<code>Tokens(interface{})</code> in the following way:</p><table><thead><tr><th><code>Type()</code> return value</th><th><code>Tokens(interface{})</code> input type</th></tr></thead><tbody><tr><td><code>"int"</code></td><td><code>int64</code></td></tr><tr><td><code>"float"</code></td><td><code>float64</code></td></tr><tr><td><code>"string"</code></td><td><code>string</code></td></tr><tr><td><code>"bool"</code></td><td><code>bool</code></td></tr><tr><td><code>"datetime"</code></td><td><code>time.Time</code></td></tr></tbody></table><h2 id=building-the-plugin>Building the plugin</h2><p>The plugin has to be built using the <code>plugin</code> build mode so that an <code>.so</code> file
is produced instead of a regular executable. For example:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>go build -buildmode=plugin -o myplugin.so ~/go/src/myplugin/main.go
</span></span></code></pre></div><h2 id=running-dgraph-with-plugins>Running Dgraph with plugins</h2><p>When starting Dgraph, use the <code>--custom_tokenizers</code> flag to tell Dgraph which
tokenizers to load. It accepts a comma separated list of plugins. E.g.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>dgraph ...other-args... --custom_tokenizers=plugin1.so,plugin2.so
</span></span></code></pre></div><div class="notices note"><span class=type>Note</span> Plugin validation is performed on startup. If a problem is detected, Dgraph
will refuse to initialize.</div><h2 id=adding-the-index-to-the-schema>Adding the index to the schema</h2><p>To use a tokenization plugin, an index has to be created in the schema.</p><p>The syntax is the same as adding any built-in index. To add an custom index
using a tokenizer plugin named <code>foo</code> to a <code>string</code> predicate named
<code>my_predicate</code>, use the following in the schema:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>my_predicate: string @index(foo) .
</span></span></code></pre></div><h2 id=using-the-index-in-queries>Using the index in queries</h2><p>There are two functions that can use custom indexes:</p><table><thead><tr><th>Mode</th><th>Behavior</th></tr></thead><tbody><tr><td><code>anyof</code></td><td>Returns nodes that match on <em>any</em> of the tokens generated</td></tr><tr><td><code>allof</code></td><td>Returns nodes that match on <em>all</em> of the tokens generated</td></tr></tbody></table><p>The functions can be used either at the query root or in filters.</p><p>There behavior here an analogous to <code>anyofterms</code>/<code>allofterms</code> and
<code>anyoftext</code>/<code>alloftext</code>.</p><h2 id=examples>Examples</h2><p>The following examples should make the process of writing a tokenization plugin
more concrete.</p><h3 id=unicode-characters>Unicode Characters</h3><p>This example shows the type of tokenization that is similar to term
tokenization of full-text search. Instead of being broken down into terms or
stem words, the text is instead broken down into its constituent unicode
codepoints (in Go terminology these are called <em>runes</em>).</p><div class="notices note"><span class=type>Note</span> This tokenizer would create a very large index that would be expensive to
manage and store. That&rsquo;s one of the reasons that text indexing usually occurs
at a higher level; stem words for full-text search or terms for term search.</div><p>The implementation of the plugin looks like this:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#00f>package</span> main
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>import</span> <span style=color:#a31515>&#34;encoding/binary&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>func</span> Tokenizer() <span style=color:#00f>interface</span>{} { <span style=color:#00f>return</span> RuneTokenizer{} }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>type</span> RuneTokenizer <span style=color:#00f>struct</span>{}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>func</span> (RuneTokenizer) Name() <span style=color:#2b91af>string</span>     { <span style=color:#00f>return</span> <span style=color:#a31515>&#34;rune&#34;</span> }
</span></span><span style=display:flex><span><span style=color:#00f>func</span> (RuneTokenizer) Type() <span style=color:#2b91af>string</span>     { <span style=color:#00f>return</span> <span style=color:#a31515>&#34;string&#34;</span> }
</span></span><span style=display:flex><span><span style=color:#00f>func</span> (RuneTokenizer) Identifier() <span style=color:#2b91af>byte</span> { <span style=color:#00f>return</span> 0xfd }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>func</span> (t RuneTokenizer) Tokens(value <span style=color:#00f>interface</span>{}) ([]<span style=color:#2b91af>string</span>, <span style=color:#2b91af>error</span>) {
</span></span><span style=display:flex><span>	<span style=color:#00f>var</span> toks []<span style=color:#2b91af>string</span>
</span></span><span style=display:flex><span>	<span style=color:#00f>for</span> _, r := <span style=color:#00f>range</span> value.(<span style=color:#2b91af>string</span>) {
</span></span><span style=display:flex><span>		<span style=color:#00f>var</span> buf [binary.MaxVarintLen32]<span style=color:#2b91af>byte</span>
</span></span><span style=display:flex><span>		n := binary.PutVarint(buf[:], int64(r))
</span></span><span style=display:flex><span>		tok := string(buf[:n])
</span></span><span style=display:flex><span>		toks = append(toks, tok)
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#00f>return</span> toks, <span style=color:#00f>nil</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>Hints and tips:</strong></p><ul><li><p>Inside <code>Tokens</code>, you can assume that <code>value</code> will have concrete type
corresponding to that specified by <code>Type()</code>. It&rsquo;s safe to do a type
assertion.</p></li><li><p>Even though the return value is <code>[]string</code>, you can always store non-unicode
data inside the string. See <a href=https://blog.golang.org/strings>this blogpost</a>
for some interesting background how string are implemented in Go and why they
can be used to store non-textual data. By storing arbitrary data in the string,
you can make the index more compact. In this case, varints are stored in the
return values.</p></li></ul><p>Setting up the indexing and adding data:</p><pre tabindex=0><code>name: string @index(rune) .
</code></pre><pre tabindex=0><code>{
  set{
    _:ad &lt;name&gt; &#34;Adam&#34; .
    _:ad &lt;dgraph.type&gt; &#34;Person&#34; .
    _:aa &lt;name&gt; &#34;Aaron&#34; .
    _:aa &lt;dgraph.type&gt; &#34;Person&#34; .
    _:am &lt;name&gt; &#34;Amy&#34; .
    _:am &lt;dgraph.type&gt; &#34;Person&#34; .
    _:ro &lt;name&gt; &#34;Ronald&#34; .
    _:ro &lt;dgraph.type&gt; &#34;Person&#34; .
  }
}
</code></pre><p>Now queries can be performed.</p><p>The only person that has all of the runes <code>A</code> and <code>n</code> in their <code>name</code> is Aaron:</p><pre tabindex=0><code>{
  q(func: allof(name, rune, &#34;An&#34;)) {
    name
  }
}
=&gt;
{
  &#34;data&#34;: {
    &#34;q&#34;: [
      { &#34;name&#34;: &#34;Aaron&#34; }
    ]
  }
}
</code></pre><p>But there are multiple people who have both of the runes <code>A</code> and <code>m</code>:</p><pre tabindex=0><code>{
  q(func: allof(name, rune, &#34;Am&#34;)) {
    name
  }
}
=&gt;
{
  &#34;data&#34;: {
    &#34;q&#34;: [
      { &#34;name&#34;: &#34;Amy&#34; },
      { &#34;name&#34;: &#34;Adam&#34; }
    ]
  }
}
</code></pre><p>Case is taken into account, so if you search for all names containing <code>"ron"</code>,
you would find <code>"Aaron"</code>, but not <code>"Ronald"</code>. But if you were to search for
<code>"no"</code>, you would match both <code>"Aaron"</code> and <code>"Ronald"</code>. The order of the runes in
the strings doesn&rsquo;t matter.</p><p>It&rsquo;s possible to search for people that have <em>any</em> of the supplied runes in
their names (rather than <em>all</em> of the supplied runes). To do this, use <code>anyof</code>
instead of <code>allof</code>:</p><pre tabindex=0><code>{
  q(func: anyof(name, rune, &#34;mr&#34;)) {
    name
  }
}
=&gt;
{
  &#34;data&#34;: {
    &#34;q&#34;: [
      { &#34;name&#34;: &#34;Adam&#34; },
      { &#34;name&#34;: &#34;Aaron&#34; },
      { &#34;name&#34;: &#34;Amy&#34; }
    ]
  }
}
</code></pre><p><code>"Ronald"</code> doesn&rsquo;t contain <code>m</code> or <code>r</code>, so isn&rsquo;t found by the search.</p><div class="notices note"><span class=type>Note</span><p>Understanding what&rsquo;s going on under the hood can help you intuitively
understand how <code>Tokens</code> method should be implemented.</p><p>When Dgraph sees new edges that are to be indexed by your tokenizer, it
will tokenize the value. The resultant tokens are used as keys for posting
lists. The edge subject is then added to the posting list for each token.</p><p>When a query root search occurs, the search value is tokenized. The result of
the search is all of the nodes in the union or intersection of the corresponding
posting lists (depending on whether <code>anyof</code> or <code>allof</code> was used).</p></div><h3 id=cidr-range>CIDR Range</h3><p>Tokenizers don&rsquo;t always have to be about splitting text up into its constituent
parts. This example indexes <a href=https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing>IP addresses into their CIDR
ranges</a>. This
allows you to search for all IP addresses that fall into a particular CIDR
range.</p><p>The plugin code is more complicated than the rune example. The input is an IP
address stored as a string, e.g. <code>"100.55.22.11/32"</code>. The output are the CIDR
ranges that the IP address could possibly fall into. There could be up to 32
different outputs (<code>"100.55.22.11/32"</code> does indeed have 32 possible ranges, one
for each mask size).</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#00f>package</span> main
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>import</span> <span style=color:#a31515>&#34;net&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>func</span> Tokenizer() <span style=color:#00f>interface</span>{} { <span style=color:#00f>return</span> CIDRTokenizer{} }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>type</span> CIDRTokenizer <span style=color:#00f>struct</span>{}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>func</span> (CIDRTokenizer) Name() <span style=color:#2b91af>string</span>     { <span style=color:#00f>return</span> <span style=color:#a31515>&#34;cidr&#34;</span> }
</span></span><span style=display:flex><span><span style=color:#00f>func</span> (CIDRTokenizer) Type() <span style=color:#2b91af>string</span>     { <span style=color:#00f>return</span> <span style=color:#a31515>&#34;string&#34;</span> }
</span></span><span style=display:flex><span><span style=color:#00f>func</span> (CIDRTokenizer) Identifier() <span style=color:#2b91af>byte</span> { <span style=color:#00f>return</span> 0xff }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>func</span> (t CIDRTokenizer) Tokens(value <span style=color:#00f>interface</span>{}) ([]<span style=color:#2b91af>string</span>, <span style=color:#2b91af>error</span>) {
</span></span><span style=display:flex><span>	_, ipnet, err := net.ParseCIDR(value.(<span style=color:#2b91af>string</span>))
</span></span><span style=display:flex><span>	<span style=color:#00f>if</span> err != <span style=color:#00f>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#00f>return</span> <span style=color:#00f>nil</span>, err
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	ones, bits := ipnet.Mask.Size()
</span></span><span style=display:flex><span>	<span style=color:#00f>var</span> toks []<span style=color:#2b91af>string</span>
</span></span><span style=display:flex><span>	<span style=color:#00f>for</span> i := ones; i &gt;= 1; i-- {
</span></span><span style=display:flex><span>		m := net.CIDRMask(i, bits)
</span></span><span style=display:flex><span>		tok := net.IPNet{
</span></span><span style=display:flex><span>			IP:   ipnet.IP.Mask(m),
</span></span><span style=display:flex><span>			Mask: m,
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>		toks = append(toks, tok.String())
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#00f>return</span> toks, <span style=color:#00f>nil</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>An example of using the tokenizer:</p><p>Setting up the indexing and adding data:</p><pre tabindex=0><code>ip: string @index(cidr) .
</code></pre><pre tabindex=0><code>{
  set{
    _:a &lt;ip&gt; &#34;100.55.22.11/32&#34; .
    _:b &lt;ip&gt; &#34;100.33.81.19/32&#34; .
    _:c &lt;ip&gt; &#34;100.49.21.25/32&#34; .
    _:d &lt;ip&gt; &#34;101.0.0.5/32&#34; .
    _:e &lt;ip&gt; &#34;100.176.2.1/32&#34; .
  }
}
</code></pre><pre tabindex=0><code>{
  q(func: allof(ip, cidr, &#34;100.48.0.0/12&#34;)) {
    ip
  }
}
=&gt;
{
  &#34;data&#34;: {
    &#34;q&#34;: [
      { &#34;ip&#34;: &#34;100.55.22.11/32&#34; },
      { &#34;ip&#34;: &#34;100.49.21.25/32&#34; }
    ]
  }
}
</code></pre><p>The CIDR ranges of <code>100.55.22.11/32</code> and <code>100.49.21.25/32</code> are both
<code>100.48.0.0/12</code>. The other IP addresses in the database aren&rsquo;t included in the
search result, since they have different CIDR ranges for 12 bit masks
(<code>100.32.0.0/12</code>, <code>101.0.0.0/12</code>, <code>100.154.0.0/12</code> for <code>100.33.81.19/32</code>,
<code>101.0.0.5/32</code>, and <code>100.176.2.1/32</code> respectively).</p><p>Note that we&rsquo;re using <code>allof</code> instead of <code>anyof</code>. Only <code>allof</code> will work
correctly with this index. Remember that the tokenizer generates all possible
CIDR ranges for an IP address. If we were to use <code>anyof</code> then the search result
would include all IP addresses under the 1 bit mask (in this case, <code>0.0.0.0/1</code>,
which would match all IPs in this dataset).</p><h3 id=anagram>Anagram</h3><p>Tokenizers don&rsquo;t always have to return multiple tokens. If you just want to
index data into groups, have the tokenizer just return an identifying member of
that group.</p><p>In this example, we want to find groups of words that are
<a href=https://en.wikipedia.org/wiki/Anagram>anagrams</a> of each
other.</p><p>A token to correspond to a group of anagrams could just be the letters in the
anagram in sorted order, as implemented below:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#00f>package</span> main
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>import</span> <span style=color:#a31515>&#34;sort&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>func</span> Tokenizer() <span style=color:#00f>interface</span>{} { <span style=color:#00f>return</span> AnagramTokenizer{} }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>type</span> AnagramTokenizer <span style=color:#00f>struct</span>{}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>func</span> (AnagramTokenizer) Name() <span style=color:#2b91af>string</span>     { <span style=color:#00f>return</span> <span style=color:#a31515>&#34;anagram&#34;</span> }
</span></span><span style=display:flex><span><span style=color:#00f>func</span> (AnagramTokenizer) Type() <span style=color:#2b91af>string</span>     { <span style=color:#00f>return</span> <span style=color:#a31515>&#34;string&#34;</span> }
</span></span><span style=display:flex><span><span style=color:#00f>func</span> (AnagramTokenizer) Identifier() <span style=color:#2b91af>byte</span> { <span style=color:#00f>return</span> 0xfc }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>func</span> (t AnagramTokenizer) Tokens(value <span style=color:#00f>interface</span>{}) ([]<span style=color:#2b91af>string</span>, <span style=color:#2b91af>error</span>) {
</span></span><span style=display:flex><span>	b := []byte(value.(<span style=color:#2b91af>string</span>))
</span></span><span style=display:flex><span>	sort.Slice(b, <span style=color:#00f>func</span>(i, j <span style=color:#2b91af>int</span>) <span style=color:#2b91af>bool</span> { <span style=color:#00f>return</span> b[i] &lt; b[j] })
</span></span><span style=display:flex><span>	<span style=color:#00f>return</span> []<span style=color:#2b91af>string</span>{string(b)}, <span style=color:#00f>nil</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>In action:</p><p>Setting up the indexing and adding data:</p><pre tabindex=0><code>word: string @index(anagram) .
</code></pre><pre tabindex=0><code>{
  set{
    _:1 &lt;word&gt; &#34;airmen&#34; .
    _:2 &lt;word&gt; &#34;marine&#34; .
    _:3 &lt;word&gt; &#34;beat&#34; .
    _:4 &lt;word&gt; &#34;beta&#34; .
    _:5 &lt;word&gt; &#34;race&#34; .
    _:6 &lt;word&gt; &#34;care&#34; .
  }
}
</code></pre><pre tabindex=0><code>{
  q(func: allof(word, anagram, &#34;remain&#34;)) {
    word
  }
}
=&gt;
{
  &#34;data&#34;: {
    &#34;q&#34;: [
      { &#34;word&#34;: &#34;airmen&#34; },
      { &#34;word&#34;: &#34;marine&#34; }
    ]
  }
}
</code></pre><p>Since a single token is only ever generated, it doesn&rsquo;t matter if <code>anyof</code> or
<code>allof</code> is used. The result will always be the same.</p><h3 id=integer-prime-factors>Integer prime factors</h3><p>All of the custom tokenizers shown previously have worked with strings.
However, other data types can be used as well. This example is contrived, but
nonetheless shows some advanced usages of custom tokenizers.</p><p>The tokenizer creates a token for each prime factor in the input.</p><pre tabindex=0><code>package main

import (
    &#34;encoding/binary&#34;
    &#34;fmt&#34;
)

func Tokenizer() interface{} { return FactorTokenizer{} }

type FactorTokenizer struct{}

func (FactorTokenizer) Name() string     { return &#34;factor&#34; }
func (FactorTokenizer) Type() string     { return &#34;int&#34; }
func (FactorTokenizer) Identifier() byte { return 0xfe }

func (FactorTokenizer) Tokens(value interface{}) ([]string, error) {
    x := value.(int64)
    if x &lt;= 1 {
        return nil, fmt.Errorf(&#34;Cannot factor int &lt;= 1: %d&#34;, x)
    }
    var toks []string
    for p := int64(2); x &gt; 1; p++ {
        if x%p == 0 {
            toks = append(toks, encodeInt(p))
            for x%p == 0 {
                x /= p
            }
        }
    }
    return toks, nil

}

func encodeInt(x int64) string {
    var buf [binary.MaxVarintLen64]byte
    n := binary.PutVarint(buf[:], x)
    return string(buf[:n])
}
</code></pre><div class="notices note"><span class=type>Note</span> Notice that the return of <code>Type()</code> is <code>"int"</code>, corresponding to the concrete
type of the input to <code>Tokens</code> (which is <code>int64</code>).</div><p>This allows you do things like search for all numbers that share prime
factors with a particular number.</p><p>In particular, we search for numbers that contain any of the prime factors of
15, i.e. any numbers that are divisible by either 3 or 5.</p><p>Setting up the indexing and adding data:</p><pre tabindex=0><code>num: int @index(factor) .
</code></pre><pre tabindex=0><code>{
  set{
    _:2 &lt;num&gt; &#34;2&#34;^^&lt;xs:int&gt; .
    _:3 &lt;num&gt; &#34;3&#34;^^&lt;xs:int&gt; .
    _:4 &lt;num&gt; &#34;4&#34;^^&lt;xs:int&gt; .
    _:5 &lt;num&gt; &#34;5&#34;^^&lt;xs:int&gt; .
    _:6 &lt;num&gt; &#34;6&#34;^^&lt;xs:int&gt; .
    _:7 &lt;num&gt; &#34;7&#34;^^&lt;xs:int&gt; .
    _:8 &lt;num&gt; &#34;8&#34;^^&lt;xs:int&gt; .
    _:9 &lt;num&gt; &#34;9&#34;^^&lt;xs:int&gt; .
    _:10 &lt;num&gt; &#34;10&#34;^^&lt;xs:int&gt; .
    _:11 &lt;num&gt; &#34;11&#34;^^&lt;xs:int&gt; .
    _:12 &lt;num&gt; &#34;12&#34;^^&lt;xs:int&gt; .
    _:13 &lt;num&gt; &#34;13&#34;^^&lt;xs:int&gt; .
    _:14 &lt;num&gt; &#34;14&#34;^^&lt;xs:int&gt; .
    _:15 &lt;num&gt; &#34;15&#34;^^&lt;xs:int&gt; .
    _:16 &lt;num&gt; &#34;16&#34;^^&lt;xs:int&gt; .
    _:17 &lt;num&gt; &#34;17&#34;^^&lt;xs:int&gt; .
    _:18 &lt;num&gt; &#34;18&#34;^^&lt;xs:int&gt; .
    _:19 &lt;num&gt; &#34;19&#34;^^&lt;xs:int&gt; .
    _:20 &lt;num&gt; &#34;20&#34;^^&lt;xs:int&gt; .
    _:21 &lt;num&gt; &#34;21&#34;^^&lt;xs:int&gt; .
    _:22 &lt;num&gt; &#34;22&#34;^^&lt;xs:int&gt; .
    _:23 &lt;num&gt; &#34;23&#34;^^&lt;xs:int&gt; .
    _:24 &lt;num&gt; &#34;24&#34;^^&lt;xs:int&gt; .
    _:25 &lt;num&gt; &#34;25&#34;^^&lt;xs:int&gt; .
    _:26 &lt;num&gt; &#34;26&#34;^^&lt;xs:int&gt; .
    _:27 &lt;num&gt; &#34;27&#34;^^&lt;xs:int&gt; .
    _:28 &lt;num&gt; &#34;28&#34;^^&lt;xs:int&gt; .
    _:29 &lt;num&gt; &#34;29&#34;^^&lt;xs:int&gt; .
    _:30 &lt;num&gt; &#34;30&#34;^^&lt;xs:int&gt; .
  }
}
</code></pre><pre tabindex=0><code>{
  q(func: anyof(num, factor, 15)) {
    num
  }
}
=&gt;
{
  &#34;data&#34;: {
    &#34;q&#34;: [
      { &#34;num&#34;: 3 },
      { &#34;num&#34;: 5 },
      { &#34;num&#34;: 6 },
      { &#34;num&#34;: 9 },
      { &#34;num&#34;: 10 },
      { &#34;num&#34;: 12 },
      { &#34;num&#34;: 15 },
      { &#34;num&#34;: 18 }
      { &#34;num&#34;: 20 },
      { &#34;num&#34;: 21 },
      { &#34;num&#34;: 25 },
      { &#34;num&#34;: 24 },
      { &#34;num&#34;: 27 },
      { &#34;num&#34;: 30 },
    ]
  }
}
</code></pre></div><div class=post__comments><footer class=clearfix><a class=question-btn target=_blank href=https://discord.gg/5rPvv2Vy><i class="fa fa-question-circle"></i> Ask a Question</a>
<a class=edit-btn target=_blank href=https://github.com/libremfg/libremfg.github.io/issues><i class="fa fa-github-alt"></i> Edit Page</a></footer></div></article><div class=right-toc><nav id=TableOfContents><ul><li><a href=#caveats>Caveats</a></li><li><a href=#implementing-a-plugin>Implementing a plugin</a></li><li><a href=#building-the-plugin>Building the plugin</a></li><li><a href=#running-dgraph-with-plugins>Running Dgraph with plugins</a></li><li><a href=#adding-the-index-to-the-schema>Adding the index to the schema</a></li><li><a href=#using-the-index-in-queries>Using the index in queries</a></li><li><a href=#examples>Examples</a><ul><li><a href=#unicode-characters>Unicode Characters</a></li><li><a href=#cidr-range>CIDR Range</a></li><li><a href=#anagram>Anagram</a></li><li><a href=#integer-prime-factors>Integer prime factors</a></li></ul></li></ul></nav></div></div></main><div class="modal fade" id=runnable-modal tabindex=-1 role=dialog aria-labelledby=exampleModalLabel aria-hidden=true><a href=# data-dismiss=modal class=modal-close-btn>Close</a><div class=modal-dialog role=document><div class=modal-content><div class=modal-body></div></div></div></div><script type=text/javascript src=https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js></script>
<script type=text/javascript>if(window.docsearch){var version="latest",path=window.location.pathname,arr=/(?:\/)?((?:master)|(?:v[0-9][^/]+))(?:\/)?.*$/.exec(path);arr!=null&&arr.length>1&&(version=arr[1]),window.docsearch({apiKey:"fe4cbc1640c6c87bbc5f099902d86f97",indexName:"dgraph",inputSelector:"#algolia-doc-search",algoliaOptions:{filters:`version:${version}`},debug:!1})}</script><script type=text/javascript>adroll_adv_id="L42C3U2UXBBPVAMISVXVLC",adroll_pix_id="MOR4VUNPK5B2LHEZ2NNTDX",adroll_version="2.0",function(e,t,n,s,o){e.__adroll_loaded=!0,e.adroll=e.adroll||[],e.adroll.f=["setProperties","identify","track"];var i="https://s.adroll.com/j/"+adroll_adv_id+"/roundtrip.js";for(o=0;o<e.adroll.f.length;o++)e.adroll[e.adroll.f[o]]=e.adroll[e.adroll.f[o]]||function(t){return function(){e.adroll.push([t,arguments])}}(e.adroll.f[o]);n=t.createElement("script"),s=t.getElementsByTagName("script")[0],n.async=1,n.src=i,s.parentNode.insertBefore(n,s)}(window,document),adroll.track("pageView")</script><script src=/js/clipboard.min.js></script>
<script src=/js/dgraph.js?a9873668f1334ff6c49d4edea0a4bc38></script>
<script src=/js/runnable.js?6e7f328df4134d18ba5c8dd11f84deb8></script>
<script>hljs.initHighlightingOnLoad()</script></body></html>